<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:10pt;font-family:URW Gothic L">
<p><span style="font-size:24pt;font-weight:600">Kamaelia Project Development</span></p>
<p align="right"><span style="font-size:18pt">How do you work, how can I join in?</span></p>
<p>SInce Kamaelia is exploring a new way of building software in many respects, it's worth discussing how Kamaelia development is managed. (If you think it's old hat, <a href="mailto:kamaelia-list@lists.sourceforge.net">please tell us!</a>) The idea is to allow exploration of ideas in a shared collaborative environment without imposing too many risks (Risks can be bad builds, bad code, bad design decisions, etc). </p>
<p>Whilst we talk here about development of the Kamaelia project here, when you're developing using Kamaelia, it's likely that locally you will go through a similar set of phases. Even if you're working on something completely different to us, take a look at this and if you think it's compatible (or could be) with your development processes, consider asking for access to use (initially perhaps) the /Sketches space, whether your 6 or 60.</p>
<p>Oh, and this page is largely about results since that's largely what we're interested in, yes? We have a separate page about meetings, and stuff like that.</p>
<p><span style="font-size:18pt;font-weight:600">Version control</span></p>
<p>All development for Kamaelia is done under version control. At present this is using sourceforge CVS. At some point in the relative near future this will change to SVN (subversion). All file paths below are relative to the CVSROOT. For reference, the CVSROOT currently contains the following top level entries. The interesting entries with regard to this page have a short description below.</p>
<ul type="disc"><li><span style="font-family:Courier;font-weight:600">/Sketches</span> (dir)</li>
<ul type="disc"><li>This is where development of an exploratory nature occurs. ie &quot;we don't know what this code should look like yet&quot;.</li></ul>
<li><span style="font-family:Courier;font-weight:600">/Code</span> (dir)</li>
<ul type="disc"><li>This is where development with a view to some form of release is made. </li></ul>
<li><span style="font-family:Courier;font-weight:600">/Tests</span> (dir)</li>
<ul type="disc"><li>Becomes relavant after a 1.0 release and/or code maturity.</li></ul>
<li><span style="font-family:Courier;font-weight:600">/AUTHORS</span>, <span style="font-family:Courier;font-weight:600">/COPYING</span>, <span style="font-family:Courier;font-weight:600">/CVSROOT</span> (dir), <span style="font-family:Courier;font-weight:600">/Other</span> (dir), <span style="font-family:Courier;font-weight:600">/Website</span> (dir)</li></ul>
<p>Any re-development of code in <span style="font-family:Courier;font-weight:600">/Code</span> - such as large scale refactoring - should occur on a branch, see below. To make life simple for everyone, the branch should be of the entire development tree.</p>
<p><span style="font-size:18pt;font-weight:600">Exploratory Development in </span><span style="font-family:Courier;font-size:18pt;font-weight:600">/Sketches</span></p>
<p>Why sketches? There are two competing theories regarding how software development works. One is that it is an engineering discipline and that if you know your requirements, or the requirements are sufficiently detailed that you can start with a spec and work forwards. This applies to both &quot;Big design up front&quot; and to a lesser extent many agile development processes.</p>
<p>A competing idea is that software development is like writing or painting specifically. If you look at any long term developer, often you will find they write small throwaway stubs of code to see how something might work - especially if there are no clear requirements to start off with. If you look at painters, you will find that for every large painting, many painters will paint or draw a relatively large number of sketches before taking the best of these sketches and integrating them into a single coherant whole.</p>
<p>In many respects, the idea &quot;let's produce a mock up of the system&quot; or &quot;let's build a prototype to see what they really want&quot; are examples of these sorts of sketches. Once you have these you can often understand the requirements of the system better, and then work on an engineered approach. Kamaelia's development process is designed to support the creative &quot;we don't know what we want, so let's sketch out a few ideas&quot; development through to the fully engineered test-driven development approach.</p>
<p>Put another way, both viewpoints have merit, and one group may term itself hackers (not to be confused with crackers) or even artists, the other may term themselves engineers or even computer scientists. Reality of development often sits somewhere between the two positions. We aim to support both approaches in a way that both groups deem reasonable.</p>
<p>Let's follow this through in the next few sections of this document.</p>
<p><span style="font-size:14pt;font-weight:600">Creating working space in </span><span style="font-family:Courier;font-size:14pt;font-weight:600">/Sketches</span></p>
<p dir="ltr">Suppose first of all our name is &quot;Warren W. King&quot; (This will be important as we go through). Furthermore, suppose we want to create QT based components, and we suspect that at some point we may need to change some other components and maybe even Axon for performances reasons. However initially, we really don't know what this will look like. Our initial step is to create ourselves some working space.</p>
<p dir="ltr">Since our name is Warren W King, we automatically have the right to create the directory <span style="font-family:Courier;font-weight:600">/Sketches/WWK/</span> . This is our first piece of code, so we do that:</p>
<ul type="disc"><li dir="ltr"><span style="font-family:Courier;font-weight:600">cd Sketches</span></li>
<li dir="ltr"><span style="font-family:Courier;font-weight:600">mkdir WWK</span></li>
<li dir="ltr"><span style="font-family:Courier;font-weight:600">cvs add WWK</span></li></ul>
<p dir="ltr">This directory is ours to do with as we please. This provides us with a namespace whereby we can simply play with development of ideas that may or may not become Kamaelia components or systems at some point in time. If WWK is gone (say Wendy Wescot-Krinchbottom took it already)  just use your full name instead or something else differentiating!</p>
<p dir="ltr">In this particular case, it would make sense to create the following directories for development at that stage:</p>
<ul type="disc"><li dir="ltr"><span style="font-family:Courier;font-weight:600">/Sketches/WWK/QT/</span></li>
<li dir="ltr"><span style="font-family:Courier;font-weight:600">/Sketches/WWK/QT/test</span></li></ul>
<p>You can then experiement with various implementations. You might do one implementation, or you might do a variety. The point is though, you can develop any way you like. The advantage of doing this in the shared repository is that if you abandon your work, someone else can always pick it up later on. They'll know it might not perfect or complete, and might not have been meant seriously - because it's in sketches. But by having a shared sketch book you may save someone else time later on. Obviously you also benefit from the shared code sketch book.</p>
<p>Suppose you're now happy that your code works and is useful, and now you want to see how it might work in the repository.</p>
<p><span style="font-size:18pt;font-weight:600">Migrating from </span><span style="font-family:Courier;font-size:18pt;font-weight:600">/Sketches</span><span style="font-size:18pt;font-weight:600"> into </span><span style="font-family:Courier;font-size:18pt;font-weight:600">/Code</span></p>
<p>This is the beginning of changing from an experimental mode to a mode where we can say &quot;this is something we find useful&quot;. As a result we take some care in thinking about where code should go and the naming of component before they enter the repository. The guidelines are really as follows:</p>
<ul type="disc"><li>As far as possible, the name of the object should as obviously as possible reflect what the thing does. For example, a component that takes other components and bolts them together/plugs them into itself is termed a chassis. This name was not the first such name that was discussed, and there were a</li></ul>
<p>Please note: you might do a sketch, and put it forward to going into <span style="font-family:Courier;font-weight:600">/Code</span>, or equally someone else may do so. Don't be offended if the latter happens!</p>
<p><span style="font-size:14pt;font-weight:600">What's the structure of /Code ?</span></p>
<p>In order to understand the where something might fit, and what it might be named it's useful to know the current structure. This discussion will focus on the Python code tree.</p>
<p>Currently <span style="font-family:Courier;font-weight:600">/Code</span> is subdivided by language, then major projects &amp; bindings as follows:</p>
<ul type="disc"><li><span style="font-family:Courier;font-weight:600">/Code/CPP</span> - This is reserved largely for work developing a C++ version of Kamaelia/Axon.</li>
<li><span style="font-family:Courier;font-weight:600">/Code/Java</span> - This is reserved largely for work developing a Java version of Kamaelia/Axon.</li>
<li><span style="font-family:Courier;font-weight:600">/Code/Ruby</span> - this does not exist as yet, but if someone were to port the ideas in Kamaelia/Axon to Ruby, their implementation would be welcome here.</li>
<li><span style="font-family:Courier;font-weight:600">/Code/Python</span> - the current focus of work.</li></ul>
<p><span style="font-family:Courier;font-weight:600">/Code/Python</span> is subdivided into the following key directories:</p>
<ul type="disc"><li dir="ltr"><span style="font-family:Courier;font-weight:600">/Code/Python/Axon</span> - this contains the full distribution/development tree of the kernel of the component system</li>
<li><span style="font-family:Courier;font-weight:600">/Code/Python/Kamaelia</span> - this contains the full distribution/development tree of the bulk  of the component system - the component system user.</li>
<li><span style="font-family:Courier;font-weight:600">/Code/Python/Bindings</span> - this contains a number of python bindings for C &amp; C++ libraries that are used by a number of components. They are here because they've been developed as part of the project.</li>
<li><span style="font-family:Courier;font-weight:600">/Code/Python/Releases/</span></li>
<li>There's also a handful of scripts in this directory which are designed to simplify the process of building releases.</li></ul>
<p>In the general case, most of the time the result of work on actual components will end up in <span style="font-family:Courier;font-weight:600">/Code/Python/Kamaelia</span>. For example <span style="font-family:Courier;font-weight:600">Kamaelia.Internet.UDP.SimplePeer</span> resides inside the file <span style="font-family:Courier;font-weight:600">/Code/Python/Kamaelia/Kamaelia/Internet/UDP.py</span> (at present).</p>
<p>Before making changes to <span style="font-family:Courier;font-weight:600">/Code</span> (on a shared branch - such as a default checkout), please discuss them first on either <span style="font-family:Courier;font-weight:600">#kamaelia</span> on freenode's IRC or on the kamaelia mailing list. You will find we are generally accommodating towards requests, but ask you to have some patience, since we might have nefarious plans you're not aware of :-)</p>
<p><span style="font-size:14pt;font-weight:600">Criterion for something going in </span><span style="font-family:Courier;font-size:14pt;font-weight:600">/Code</span></p>
<p>Code that goes into <span style="font-family:Courier;font-weight:600">/Code</span> does NOT automatically go into the release tar ball (that is generated from the <span style="font-family:Courier;font-weight:600">RELEASE</span> branch, which will be discussed below).As a result the criterion for something going into <span style="font-family:Courier;font-weight:600">/Code</span> is simply &quot;this is something we've found useful for <span style="font-family:Courier;font-weight:600">&lt;bla&gt;</span>, and would now like to try using it in other things and seeing how it fits&quot;. </p>
<p>However, recently we added a simple rule for things that go in <span style="font-family:Courier;font-weight:600">/Code</span> - they MUST have a <span style="font-style:italic">simple</span> working example to accompany it. Generally you'll probably already have this, since you've been using it sketches and found it useful. The reason for this is because such an example forms a simple acceptance test of your code. This example also explains to others what your component does, and how to use it, and as a result forms minimal documentation for the component. </p>
<p>It is also very strongly encouraged that you add at the end of every file you add in <span style="font-family:Courier;font-weight:600">/Code</span> a line similar to this:</p>
<ul type="disc"><div dir="ltr"><span style="font-family:Courier;font-weight:600">__kamaelia_components__  = ( BasicPeer, SimplePeer, TargettedPeer, PostboxPeer, )</span></div></ul>
<p>ie declare a global variable that contains a tuple with a references to all the classes you've made in that file. This will mean that any documentation you write will be automagically picked up and added to the documentation tree. It also means that your component will be available to graphical pipeline editors and so on.</p>
<p>This line should (obviously?) come BEFORE any <span style="font-family:Courier;font-weight:600">if __name__ == &quot;__main__&quot;: ...</span> line, and also should be a top level statement</p>
<p dir="ltr"><span style="font-weight:600">Note:</span> Not all components in <span style="font-family:Courier;font-weight:600">/Code</span> currently have an example. This is due to the development process evolving over time, and becoming more concrete about what's useful. Also, depending on how useful we percieve your component to be, we may waive this requirement in favour of seeing what can be done.</p>
<p dir="ltr">If you do NOT feel you have time to hang around and wait for us (perhaps only a few hours), please see discussion of the <span style="font-family:Courier;font-weight:600">CHAOS</span> branch below.</p>
<p dir="ltr"><span style="font-size:18pt;font-weight:600">Use of CVS Branches in Kamaelia</span></p>
<p dir="ltr">The bulk of day to day development with a view to release occurs on the CVS <span style="font-family:Courier;font-weight:600">HEAD</span>. This is a deliberate concious choice, since it's the natural working point that new developers - especially those new to version control - start from. However, CVS branches can be used for many things, and rather than set up a system where you have to ask permission, we prefer to have a situation where you can just get on with development. This section discusses various branches/branch types</p>
<p dir="ltr"><span style="font-family:Courier;font-size:14pt;font-weight:600">HEAD</span><span style="font-size:14pt;font-weight:600"> branch</span></p>
<p dir="ltr">This is as noted where development happens, often with a view to a release. Code that is merged in <span style="font-family:Courier;font-weight:600">/Code/Python/Kamaelia</span> is expected to be a candidate for adding to the <span style="font-family:Courier;font-weight:600">RELEASE</span> branch at some point, but is not automatically added. Due to this expected next step, it is expected that people committing to the CVS HEAD in <span style="font-family:Courier;font-weight:600">/Code/Python/Kamaelia</span> will discuss what they're doing on either IRC (<span style="font-family:Courier;font-weight:600">#kamaelia, freenode</span>), or on the mailing list, or similar. Should a process be needed, it will be invented as it becomes apparent :-) It will probably take a form similar to that used on python-dev. Project admins act as arbiters if there's a loggerhead.</p>
<p dir="ltr">If you want to make experimental sweeping changes you need to use a branch - either personal one, or the <span style="font-family:Courier;font-weight:600">CHAOS</span> branch.</p>
<p><span style="font-family:Courier;font-size:14pt;font-weight:600">RELEASE</span><span style="font-size:14pt;font-weight:600"> branch</span></p>
<p dir="ltr"><span style="font-style:italic;font-weight:600">No editting </span><span style="font-style:italic;font-weight:600;text-decoration:underline">at all</span><span style="font-style:italic;font-weight:600"> happens on the release branch. </span> This tracks the actual releases. It's function is to simplify the automated release build. Files are manually added to the release branch, but automatically mirrored and updated from HEAD at release point.</p>
<p dir="ltr">Criterion (as of April 2006) for adding to the release branch:</p>
<ul type="disc"><li dir="ltr">Shown to be stable</li>
<li dir="ltr">Has an example in <span style="font-family:Courier;font-weight:600">/Code/Python/Kamaelia/Examples</span></li>
<li dir="ltr">Has pydoc style documentation of the code</li></ul>
<p dir="ltr">Desirable when adding to the release branch:</p>
<ul type="disc"><li dir="ltr">Full coverage test suite. Note, this is desirable. Anything added without full coverage testing is considered either alpha or beta quality. This would be expected to reside initially in a subdirectory called test. As time matures, this will move out to /Tests/Python/Kamaelia - in the same way as /Tests/Python/Axon today. Tests should NOT move into /Tests/Python/Kamaelia until they are older than 1 year, and not expected to change. The reason for this delay is to find out whether they're a mistake or not! (As a result 1 year is meant to signify &quot;a significant time period&quot;, rather than be prescriptive)</li></ul>
<p dir="ltr">Expected development regarding code on the <span style="font-family:Courier;font-weight:600">RELEASE</span> branch:</p>
<ul type="disc"><li dir="ltr">Code added without full coverage testing is expected to gain a full coverage test suite over time. This may lead to reimplementation of the modue based on experience of using the module. Experience has shown that modules reimplemented test first after this process have a level of use &amp; maturity which is extremely useful.</li></ul>
<p>Adding something to the release branch should only be done with the knowledge of a project admin. (Hey, that's part ofthe idea of project <span style="font-style:italic;font-weight:600">admin</span> after all. Whilst this may seem restrictive, it's simply to ensure a level of consistency, and in practice will often be a very short discussion.</p>
<p><span style="font-size:14pt;font-weight:600">Personal Branches</span></p>
<p>Much like having a personal namespace in <span style="font-family:Courier;font-weight:600">/Sketches</span> is useful, having the ability to change anything and everything in the entire code tree is extremely useful. It's also often by far the best way of demonstrating why your point is right - why your way is better than the current method or a proposed method. It's not always the best way, but sufficiently often to be worth supporting.</p>
<p>As was hinted above in &quot;Version Control&quot;, if you do make a branch it should be across the whole code tree, and we have a naming mechanism to simplify things. Suppose once again your name is Warren W King. Suppose also you were the first person with those initials to start developing things in Kamaelia, so your subdirectory name in <span style="font-family:Courier;font-weight:600">/Sketches</span> is <span style="font-family:Courier;font-weight:600">/Sketches/WWK/</span> . ie your personal &quot;tag&quot; is <span style="font-style:italic">WWK</span><span style="font-style:italic;font-weight:600">.</span></p>
<p>For sake of argument, lets say you're doing integrations that require a variety of changes in the code tree in various locations, based on some changes in perspective the implementation of the QT module we described above. You might consider calling that <span style="font-family:Courier;font-weight:600">INTEGRATION_BOOSTS</span> . However this precludes someone else using the same name.</p>
<p>As a result the suggested approach is to name your personal branches as:</p>
<ul type="disc"><li dir="ltr"><span style="font-family:Courier;font-weight:600">private_</span><span style="font-family:Courier;font-style:italic;font-weight:600">YOURTAG</span><span style="font-family:Courier;font-weight:600">_</span><span style="font-family:Courier;font-style:italic;font-weight:600">Anything_You_Like</span></li></ul>
<p dir="ltr">So in this case, the branch name would be:</p>
<ul type="disc"><li dir="ltr"><span style="font-family:Courier;font-weight:600">private_WWK_INTEGRATION_BOOSTS</span></li></ul>
<p dir="ltr">Again, personally I'd suggested something more descriptive/precise like <span style="font-family:Courier;font-weight:600">private_WWK_QT_INTEGRATION_BOOSTS</span>, but any branch with a name starting <span style="font-family:Courier;font-weight:600">private_</span><span style="font-family:Courier;font-style:italic;font-weight:600">YOURTAG</span> is yours to do as you will. This allows others to see what's happening and share ideas, and see your ideas as they develop.</p>
<p dir="ltr"><span style="font-weight:600">There is a special rule here though: you are NOT allowed to merge a branch you create (unless all project admins agree)</span>. The reason for this is this means someone else has to merge it. This automatically gains 2 things - peer review of code, and also it means that at least 2 people understand the changes embodied in the code. Where possible, <span style="font-style:italic">please </span>include documentation since it's a pain to add later on!</p>
<p>If you don't know how to create branches, please just say it's relatively simple, but remember the rule - the branch must be across the entire tree.</p>
<p><span style="font-size:14pt;font-weight:600">Agent of </span><span style="font-family:Courier;font-size:14pt;font-weight:600">CHAOS</span><span style="font-size:14pt;font-weight:600"> branch</span></p>
<p>If you feel the need to try out radical new ideas, AND also want to have shared development of them, please use the <span style="font-family:Courier;font-weight:600">CHAOS</span> branch. Co-ordinate amongst yourselves what you want to do and what the ground rules are. If you're making someone upset here, you're doing something wrong.</p>
<p>If the main CVS head ends up having too much control, the <span style="font-family:Courier;font-weight:600">CHAOS</span> branch is design to allow you to bypass that control and produce your own version that potentially has different goals from the project admin. If this idea sounds familiar, it's because it's the approach that governs the development of content on wikis, and we'd like to run the <span style="font-family:Courier;font-weight:600">CHAOS</span> branch in that way - you get to add things and work on things your way. If you break things, your code may get reverted by someone else, or changed by someone else.</p>
<p>In theory this sounds like complete anarchy and like it wouldn't work. Experience with another project has shown that if it's taken on board in the manner as described above (never ask permission on <span style="font-family:Courier;font-weight:600">CHAOS</span>) then you can get great creative drives and experience from trying out a variety of ideas quickly and effectively.</p>
<p><span style="font-weight:600">Note: </span>This branch does not exist at time of writing, but this document allows for its existance. If you feel the need to use the <span style="font-family:Courier;font-weight:600">CHAOS</span> branch, please just create and use it.</p>
<p dir="ltr"><span style="font-size:18pt;font-weight:600">Final points</span></p>
<p>This process is designed to allow freedom for creativity on the small scale, large scale and group scale. It's also designed to protect the quality of releases as time progresses. In practice it's light touch, despite the length of this document:</p>
<ul type="disc"><li>Experiment in <span style="font-family:Courier;font-weight:600">/Sketches/INITIALS</span></li>
<li>Move working things into <span style="font-family:Courier;font-weight:600">/Code</span></li>
<li>Solidify into something we can trust</li>
<li>Add test suites</li>
<li>Preferably re-implement test first</li>
<li>Make large swathe changes in branches called <span style="font-family:Courier;font-weight:600">private_INITIALS_AnythingYouWant</span></li>
<li>Be prepared to merge other people's branches</li>
<ul type="disc"><li>Remember you are not allowed to merge your own branch into the head without the permission of the project admins - to encourage peer review, knowledge sharing and collaboration.</li></ul>
<li>If all else fails, become an agent of <span style="font-family:Courier;font-weight:600">CHAOS</span> :-)</li>
<ul type="disc"><li>And yes, if this happens we'll with release scripts. </li>
<li>Obviously this is a place to edit things and just have fun if the above process isn't your thing :-)</li></ul></ul>
<p dir="ltr"><span style="font-weight:600">General Guiding Principles with Regard to Decisions mentioned above</span></p>
<ul type="disc"><li dir="ltr">Descriptions of things optimised for the 80% of programmers are preferable to those with only the top 20% will understand. If this seems &quot;dumbing down&quot;, consider that it is often harder to describe something complex simply, than to describe something simple in a complex fashion. Remember that a key aim is to make life easier for the bulk of programmers, with a recognition that its worth optimising for maintenance.<br /></li>
<li dir="ltr">Fun descriptions, ideas and code tend to win arguments :-)<br /></li>
<li dir="ltr">You're going to get it wrong. Whether you like it or not, something you do will go wrong and be very wrong. We'd like to aim for a very high hit rate of &quot;good&quot; decisions, but often the only way to find out what the &quot;right&quot; answer is to actually try something and find out. Please don't be afraid of pointing out the emperor has new clothes. We might be embarrassed (possibly even upset) for a while, but we'd rather be told and know when we've got something wrong. We're human too after all :-) For a good discourse on why it's worth taking this risk, read Paul Arden's excellent (and brief!) read &quot;Whatever you think, think opposite&quot;.<br /></li>
<ul type="disc"><li dir="ltr">A corrollary of this is that it might make sense occasionally to do sketches and branches of ideas that you think are really bad ideas and see how they pan out!<br /></li></ul>
<li dir="ltr">Implementations change, but interfaces stay the same. If the interfaces change, you've written something new. ie you may add new inboxes and outboxes to components, but if you change behaviours of existing in-/out-boxes you should consider whether you're actually writing something new. If in doubt, talk to the team.<br /></li>
<li dir="ltr">Quick, simple, clear, justified decisions (But not hasty).<br /></li>
<li dir="ltr">All rules have exceptions.<br /></li>
<li dir="ltr"><span style="font-family:Courier;font-weight:600">import this</span> :-)<br /></li>
<li dir="ltr">Oh, and if it's not blatantly obvious, yes we'd like to allow you to check in. We have <span style="font-family:Courier;font-weight:600">cvs_acl</span>s we could use to protect our code if we think you're acting badly, so we're not afraid to share our workspace, we'd love for you to find Kamaelia as useful as we do.</li></ul>
<p dir="ltr"><span style="font-size:18pt;font-weight:600">Comments</span></p>
<p dir="ltr">Any comments on this approach welcome. If we're doing something dumb, please tell us. If you like it and adopt something similar, let us know. The project is as much about how work is done as it is about what gets produced. </p>
<p></p>
</body></html>
