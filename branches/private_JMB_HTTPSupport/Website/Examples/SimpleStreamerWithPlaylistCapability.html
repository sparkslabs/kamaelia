<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:10pt;font-family:URW Gothic L">
<p><span style="font-size:24pt;font-weight:600">Cookbook Example</span></p>
<p align="right"><span style="font-size:18pt">How can I...?</span></p>
<p>Example 12 : Simple TCP based streamer that repeatedly streams (3 times) the same audio file. The reason it's the same file is because it's configured with a playlist that is created:  [ shortfile, shortfile, shortfile ]. If this was [ song_one, song_two,  song_three ], then this would be a simple streamer that had a playlist of 3 songs played repeatedly. Something that does this is often referred to as a carousel. <span style="font-weight:600">Components used: </span><a href="/Components/pydoc/Kamaelia.Chassis.ConnectedServer.SimpleServer.html">SimpleServer</a>, <span style="font-style:italic;color:#ff0004">JoinChooserToCarousel</span>, <span style="font-style:italic;color:#ff0004">FixedRateControlledReusableFileReader</span>, <a href="/Components/pydoc/Kamaelia.Util.Chooser.ForwardIteratingChooser.html">ForwardIteratingChooser</a>, <a href="/Components/pydoc/Kamaelia.Util.PipelineComponent.pipeline.html">pipeline</a></p>
<ul type="disc"><div>[[pre]<span style="font-style:italic">#!/usr/bin/python</span><br /><br /><span style="font-weight:600">from</span> Kamaelia.Chassis.ConnectedServer <span style="font-weight:600">import</span> SimpleServer<br /><span style="font-weight:600">from</span> Kamaelia.Chassis.Prefab <span style="font-weight:600">import</span> JoinChooserToCarousel<br /><span style="font-weight:600">from</span> Kamaelia.File.Reading <span style="font-weight:600">import</span> FixedRateControlledReusableFileReader<br /><span style="font-weight:600">from</span> Kamaelia.Util.PipelineComponent <span style="font-weight:600">import </span>pipeline<br /><span style="font-weight:600">from</span> Kamaelia.Util.Graphline <span style="font-weight:600">import</span> Graphline<br /><span style="font-weight:600">from</span> Kamaelia.Util.Chooser <span style="font-weight:600">import</span> ForwardIteratingChooser<br /><br />shortfile = &quot;/opt/kde3/share/sounds/KDE_Startup_2.ogg&quot;<br /><br />FILES_TO_STREAM = [ shortfile, shortfile, shortfile ]<span style="font-style:italic"># [  file_to_stream, file_to_stream2 ]</span><br />BITRATE         = 800000 # 38000<br />CHUNKSIZEBYTES  = 512<br />SERVERPORT      = 1500<br /><br /><span style="font-weight:600">def </span>MultiFileReaderProtocol(filenames, bitrate, chunksizebytes):<br />    <span style="font-weight:600">def</span> protocolFactory(*argv, **argd):<br />        <span style="font-weight:600">return</span> JoinChooserToCarousel(<br />            ForwardIteratingChooser(filenames),<br />            FixedRateControlledReusableFileReader(readmode=&quot;bytes&quot;,<br />                                               rate=bitrate/8,<br />                                               chunksize=chunksizebytes)<br />          )<br />    <span style="font-weight:600">return</span> protocolFactory<br /><br /><span style="font-weight:600">if</span> __name__ == '__main__':<br />   filereader = MultiFileReaderProtocol( FILES_TO_STREAM, BITRATE, CHUNKSIZEBYTES)<br />   server     = SimpleServer( protocol = filereader, port = SERVERPORT ).run()<br />] <span style="font-weight:600">Source:</span> Examples/example12/SimpleMultiFileStreamer.py</div></ul>
<p></p>
<p></p>
</body></html>
