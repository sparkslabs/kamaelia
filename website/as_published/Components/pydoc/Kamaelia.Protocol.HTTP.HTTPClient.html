<html>
<head>
<title> Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient </title>
<link rel=stylesheet type="text/css" href="/newcss.css">
  </head>
<body style="font-size: 10pt; font-family: verdana,arial,helvetica,sans-serif; line-height: 1.8;">
</div>

</span></p>

<div id="centreinbrowser">
    <table><tr><td>
        <div id="contentwrapper">
            <div id="contentpanel">
                <div class="column twoC largertext">  &nbsp; </div>
                <div class="column twoC largertext">  &nbsp;  </div>
                <div class="column twoC largertext"> <P class="orange" align="center">  <b><a href="/Home.html"> Home</a></b> </div>
                <div class="column twoC largertext"> 
<P class="orange" align="center"> 
<b><a href="/About.html" class="smallertext">About</a>, 
<a href="/Sitemap.html" class="smallertext">Index</a>, 
<a href="/RecentChanges.html" class="smallertext">Changes</a></b>
  </div>
                <div class="column twoC largertext"> <P class="orange" align="center">  <b> <a href="/Developers/">Developers</a> </b> </div>
                <div class="column last twoC"> <P class="orange" align="center"> 
<b>
   <span class="largertext"><a href="/UserLogin.html">Login</a>/<a href="/UserRegistration.html">Register</a> </span> 
  </b>
 </div>

<div class="divide"></div>
                <div id="masthead">
                    &nbsp;
                    <br>
                </div>
                <div class="fourC column">
                    &nbsp;
                </div>
                <div class="fourC column">
                    &nbsp;
                </div>
                <div class="fourC column last">
                    &nbsp;
                </div>
<div class="divide"></div>
                <div class="twelveC column"> 
                <html>
<head>
<title>Kamaelia docs : Kamaelia.Protocol.HTTP.HTTPClient</title>
<style type="test/css">
pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }
</style>
</head>
<body>
<div class="container">
<div class="section">
<h1><a class="reference" href="/Components/pydoc/Kamaelia.html">Kamaelia</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.html">Protocol</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.html">HTTP</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.html">HTTPClient</a></h1>
</div>
<div class="section">
<div class="container">
<ul class="simple">
<li><strong>component <a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.SimpleHTTPClient.html">SimpleHTTPClient</a></strong></li>
<li><strong>component <a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.SingleShotHTTPClient.html">SingleShotHTTPClient</a></strong></li>
</ul>
</div>
<ul class="simple">
<li><a class="reference" href="#597">Single-Shot HTTP Client</a><ul>
<li><a class="reference" href="#598">Example Usage</a><ul>
</ul>
</li>
<li><a class="reference" href="#599">How does it work?</a><ul>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#600">Simple HTTP Client</a><ul>
<li><a class="reference" href="#601">Example Usage</a><ul>
</ul>
</li>
<li><a class="reference" href="#602">How does it work?</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section">
<div class="section">
<h2 id="597"><a id="single-shot-http-client" name="single-shot-http-client">Single-Shot HTTP Client</a></h2>
<p>This component is for downloading a single file from an HTTP server.
Pick up data received from the server on its &quot;outbox&quot; outbox.</p>
<p>Generally you should use SimpleHTTPClient in preference to this.</p>
<div class="section">
<h3 id="598"><a id="example-usage" name="example-usage">Example Usage</a></h3>
<p>How to use it:</p>
<pre class="literal-block">
Pipeline(
    SingleShotHTTPClient(&quot;http://www.google.co.uk/&quot;),
    SomeComponentThatUnderstandsThoseMessageTypes()
).run()
</pre>
<p>If you want to use it directly, note that it doesn't output strings
but ParsedHTTPHeader, ParsedHTTPBodyChunk and ParsedHTTPEnd like
HTTPParser. This makes has the advantage of not buffering huge
files in memory but outputting them as a stream of chunks.
(with plain strings you would not know the contents of the
headers or at what point that response had ended!)</p>
</div>
<div class="section">
<h3 id="599"><a id="how-does-it-work" name="how-does-it-work">How does it work?</a></h3>
<p>SingleShotHTTPClient accepts a URL parameter at its creation (to __init__).
When activated it creates an HTTPParser instance and then connects
to the webserver specified in the URL using a TCPClient component.
It sends an HTTP request and then any response from the server is received
by the HTTPParser.</p>
<p>HTTPParser processes the response and outputs it in parts as:</p>
<pre class="literal-block">
ParsedHTTPHeader,
ParsedHTTPBodyChunk,
ParsedHTTPBodyChunk,
...
ParsedHTTPBodyChunk,
ParsedHTTPEnd
</pre>
<p>If SingleShotHTTPClient detects that the requested URL is a redirect page
(using the Location header) then it begins this cycle anew with the URL
of the new page, otherwise the parts of the page output by HTTPParser are
sent on to &quot;outbox&quot;.</p>
</div>
</div>
<div class="section">
<h2 id="600"><a id="simple-http-client" name="simple-http-client">Simple HTTP Client</a></h2>
<p>This component downloads the pages corresponding to HTTP URLs received
on &quot;inbox&quot; and outputs their contents (file data) as a message, one per
URL, to &quot;outbox&quot; in the order they were received.</p>
<div class="section">
<h3 id="601"><a id="id1" name="id1">Example Usage</a></h3>
<p>Type URLs, and they will be downloaded and placed, back to back in &quot;downloadedfile.txt&quot;:</p>
<pre class="literal-block">
Pipeline(
    ConsoleReader(&quot;&gt;&gt;&gt; &quot;, &quot;&quot;),
    SimpleHTTPClient(),
    SimpleFileWriter(&quot;downloadedfile.txt&quot;),
).run()
</pre>
</div>
<div class="section">
<h3 id="602"><a id="id2" name="id2">How does it work?</a></h3>
<p>SimpleHTTPClient uses the Carousel component to create a new
SingleShotHTTPClient component for every URL requested. As URLs are
handled sequentially, it has only one SSHC child at anyone time.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section">
<h1><a class="reference" href="/Components/pydoc/Kamaelia.html">Kamaelia</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.html">Protocol</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.html">HTTP</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.html">HTTPClient</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.SimpleHTTPClient.html">SimpleHTTPClient</a></h1>
<div class="section">
<h2 id="symbol-SimpleHTTPClient">class SimpleHTTPClient(<a class="reference" href="/Docs/Axon/Axon.Component.component.html">Axon.Component.component</a>)</h2>
<div class="section">
<h3><a id="symbol-SimpleHTTPClient.Inboxes" name="symbol-SimpleHTTPClient.Inboxes">Inboxes</a></h3>
<ul class="simple">
<li><strong>control</strong> : Shut me down</li>
<li><strong>_carouselready</strong> : Receive NEXT when carousel has completed a request</li>
<li><strong>inbox</strong> : URLs to download - a dict {'url':'x', 'postbody':'y'} or a just the URL as a string </li>
<li><strong>_carouselinbox</strong> : Data from SingleShotHTTPClient via Carousel</li>
</ul>
</div>
<div class="section">
<h3><a id="symbol-SimpleHTTPClient.Outboxes" name="symbol-SimpleHTTPClient.Outboxes">Outboxes</a></h3>
<ul class="simple">
<li><strong>debug</strong> : Information to aid debugging</li>
<li><strong>outbox</strong> : Requested file's data string</li>
<li><strong>signal</strong> : Signal I have shutdown</li>
<li><strong>_carouselnext</strong> : Create a new SingleShotHTTPClient</li>
<li><strong>_carouselsignal</strong> : Shutdown the carousel</li>
</ul>
</div>
<div class="section">
<h3>Methods defined here</h3>
<div class="container">
<div style="float: right; border: solid;" class="twoC"> <p><strong>Warning!</strong></p>
<p>You should be using the inbox/outbox interface, not these methods (except construction). This documentation is designed as a roadmap as to their functionalilty for maintainers and new component developers.</p>
</div></div>
<div class="section">
<h4><a id="symbol-SimpleHTTPClient.__init__" name="symbol-SimpleHTTPClient.__init__">__init__(self)</a></h4>
<p>Create and link to a carousel object</p>
</div>
<div class="section">
<h4><a id="symbol-SimpleHTTPClient.cleanup" name="symbol-SimpleHTTPClient.cleanup">cleanup(self)</a></h4>
<p>Destroy child components and send producerFinished when we quit.</p>
</div>
<div class="section">
<h4><a id="symbol-SimpleHTTPClient.debug" name="symbol-SimpleHTTPClient.debug">debug(self, msg)</a></h4>
</div>
<div class="section">
<h4><a id="symbol-SimpleHTTPClient.main" name="symbol-SimpleHTTPClient.main">main(self)</a></h4>
<p>Main loop.</p>
</div>
</div>
<div class="section">
</div>
</div>
<h1><a class="reference" href="/Components/pydoc/Kamaelia.html">Kamaelia</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.html">Protocol</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.html">HTTP</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.html">HTTPClient</a>.<a class="reference" href="/Components/pydoc/Kamaelia.Protocol.HTTP.HTTPClient.SingleShotHTTPClient.html">SingleShotHTTPClient</a></h1>
<div class="section">
<h2 id="symbol-SingleShotHTTPClient">class SingleShotHTTPClient(<a class="reference" href="/Docs/Axon/Axon.Component.component.html">Axon.Component.component</a>)</h2>
<p>SingleShotHTTPClient() -&gt; component that can download a file using HTTP by URL</p>
<p>Arguments:
- starturl     -- the URL of the file to download
- [postbody]   -- data to POST to that URL - if set to None becomes an empty body in to a POST (of PUT) request
- [connectionclass] -- specify a class other than TCPClient to connect with
- [method]     -- the HTTP method for the request (default to GET normally or POST if postbody != &quot;&quot;</p>
<div class="section">
<h3><a id="symbol-SingleShotHTTPClient.Inboxes" name="symbol-SingleShotHTTPClient.Inboxes">Inboxes</a></h3>
<ul class="simple">
<li><strong>control</strong> : UNUSED</li>
<li><strong>_parserinbox</strong> : Data from HTTP parser</li>
<li><strong>_parsercontrol</strong> : Signals from HTTP parser</li>
<li><strong>_tcpcontrol</strong> : Signals from TCP client</li>
<li><strong>inbox</strong> : UNUSED</li>
</ul>
</div>
<div class="section">
<h3><a id="symbol-SingleShotHTTPClient.Outboxes" name="symbol-SingleShotHTTPClient.Outboxes">Outboxes</a></h3>
<ul class="simple">
<li><strong>signal</strong> : UNUSED</li>
<li><strong>_parsersignal</strong> : Signals for HTTP parser</li>
<li><strong>_tcpoutbox</strong> : Send over TCP connection</li>
<li><strong>debug</strong> : Output to aid debugging</li>
<li><strong>outbox</strong> : Requested file</li>
<li><strong>_tcpsignal</strong> : Signals shutdown of TCP connection</li>
</ul>
</div>
<div class="section">
<h3>Methods defined here</h3>
<div class="container">
<div style="float: right; border: solid;" class="twoC"> <p><strong>Warning!</strong></p>
<p>You should be using the inbox/outbox interface, not these methods (except construction). This documentation is designed as a roadmap as to their functionalilty for maintainers and new component developers.</p>
</div></div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.__init__" name="symbol-SingleShotHTTPClient.__init__">__init__(self, starturl[, postbody][, connectionclass][, extraheaders][, method])</a></h4>
</div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.formRequest" name="symbol-SingleShotHTTPClient.formRequest">formRequest(self, url)</a></h4>
<p>Craft a HTTP request string for the supplied url</p>
</div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.handleRedirect" name="symbol-SingleShotHTTPClient.handleRedirect">handleRedirect(self, header)</a></h4>
<p>Check for a redirect response and queue the fetching the page it points to if it is such a response.
Returns true if it was a redirect page and false otherwise.</p>
</div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.main" name="symbol-SingleShotHTTPClient.main">main(self)</a></h4>
<p>Main loop.</p>
</div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.mainBody" name="symbol-SingleShotHTTPClient.mainBody">mainBody(self)</a></h4>
<p>Called repeatedly by main loop. Checks inboxes and processes messages received.
Start the fetching of the new page if the current one is a redirect and has been
completely fetched.</p>
</div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.makeRequest" name="symbol-SingleShotHTTPClient.makeRequest">makeRequest(self, request)</a></h4>
<p>Connect to the remote HTTP server and send request</p>
</div>
<div class="section">
<h4><a id="symbol-SingleShotHTTPClient.shutdownKids" name="symbol-SingleShotHTTPClient.shutdownKids">shutdownKids(self)</a></h4>
<p>Close TCP connection and HTTP parser</p>
</div>
</div>
<div class="section">
</div>
</div>
</div>
</div>





<div class="section">
<h1>Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be clearer?
Want to help improve it? Constructive criticism is very welcome - especially if you can suggest a better rewording!</p>
<p>Please leave you feedback
<a class="reference" href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701">here</a>
in reply to the documentation thread in the Kamaelia blog.</p>
</div>


<p><i>-- Automatic documentation generator, 05 Jun 2009 at 03:01:38 UTC/GMT</i>
</body></html>

                </div> 
                <div id="footer">
                    &nbsp;
                    <br>&nbsp;
                </div>


<div class="divide"></div>
            </div>
        </div>
    </td></tr></table>


<hr>
<div id="aboutblock" style="text-align: left"; padding-left: 1em;>
<font size="-2">
   <P><img src="http://www.kamaelia.org/images/BBC-ResearchLogo-Small.png"
style="float: left; padding-right: 10px; margin-bottom: 3em;"> <a href="http://www.kamaelia.org/Home>5D">Kamaelia</a>
    is an open source project originated from and guided by BBC
    Research. For more information browse the site or get in 
    <a href="/Contact.html">contact</a>.
   <P>This is an ongoing community based development site. As a result the
   contents of this page is the opinions of the contributors of the pages
   involved not the organisations involved. Specificially, this page may
   contain personal views which are not the views of the BBC. (the site is
   powered by a wiki engine)
   <P>(C) Copyright 2008 Kamaelia Contributors, including the British
   Broadcasting Corporation, All Rights Reserved.
</font>
</div>
</div>
<div style="display:none">
This web site is powered by the same code created for the
<a href="http://www.bickermanor.org/"> bicker manor</a> project. For more
details, contact Michael Sparks at BBC Research directly (cf contact)
</div>
</body>
</html>



