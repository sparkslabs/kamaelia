<html>
<head>
<title> MobileReframer </title>
<meta name="description" content="Kamaelia - making concurrency simpler in python - MobileReframer">
<meta name="keywords" content="python concurrency generators threads processes component system experts beginners media networking">
<link rel=stylesheet type="text/css" href="/newcss.css">
  </head>
<body style="font-size: 10pt; font-family: verdana,arial,helvetica,sans-serif; line-height: 1.8;">
</div>

</span></p>

<div id="centreinbrowser">
    <table><tr><td>
        <div id="contentwrapper">
            <div id="contentpanel">
                <div class="column twoC largertext">  &nbsp; </div>
                <div class="column twoC largertext">  &nbsp;  </div>
                <div class="column twoC largertext"> <P class="orange" align="center">  <b><a href="/Home.html"> Home</a></b> </div>
                <div class="column twoC largertext"> 
<P class="orange" align="center"> 
<b><a href="/About.html" class="smallertext">About</a>, 
<a href="/Sitemap.html" class="smallertext">Index</a>, 
<a href="/RecentChanges.html" class="smallertext">Changes</a></b>
  </div>
                <div class="column twoC largertext"> <P class="orange" align="center">  <b> <a href="/Developers/">Developers</a> </b> </div>
                <div class="column last twoC"> <P class="orange" align="center"> 
<b>
<span class="largertext">&nbsp;</span>
<!--   <span class="largertext"><a href="/UserLogin.html">Login</a>/<a href="/UserRegistration.html">Register</a> </span>  -->
<!--  </b> -->
</b>
 </div>

<div class="divide"></div>
                <div id="masthead">
                    &nbsp;
                    <br>
                </div>
                <div class="fourC column">
                    &nbsp;
                </div>
                <div class="fourC column">
                    &nbsp;
                </div>
                <div class="fourC column last">
                    &nbsp;
                </div>
<div class="divide"></div>
                <div class="twoC column">
                    &nbsp;
                </div>
                <div class="eightC column">
                


<h1>MobileReframer</h1><div style="float: right; border: solid;" class="twoC"> For development/status information, see the <a href='/Developers/Projects/MobileReframer '> project task page</a> </div><br><font color="#000000"><span style="background-color: rgb(255, 255, 255);">This is a command line tool that decodes a video clip; applies edit decisisions (cutting, cropping and scaling); and re</span>-encodes it. The idea is to cut and crop video to make it suitable for playback on a small screen mobile device by zooming in onto just the important bit - such as the face of the interviewee.<br><br>You supply a set of edit decisions in an XML file, and the MobileReframer will apply those to the source video file you provide, creating a new output video file with the resolution you specify<br></font><br><h2>Getting Started</h2><p>You can find the Mobile Reframer itself in <tt> /Sketches/MH/MobileReframe</tt> in the trunk of the subversion repository.<br>
</p><h3>Pre-requisites</h3><ol><li>You must install Axon from the <tt> private_MH_outboxwakeups </tt> branch in the subversion repository. Mobile Reframer requires the new features in this branch to enable it to self rate limit without exploding memory usage!<br><br>Install it the usual way using the command line:<br>     <tt> python setup.py install</tt><br><br></li><li>You must have an installed copy of the command line ffmpeg tool, which can be obtained from <a href='http://ffmpeg.mplayerhq.hu/'> here.</a> Make sure you have all the codecs you need of course!<br></li></ol><h3>Running MobileReframer.py<br></h3>Run MobileReframer.py from the command line and you'll get usage information:<br>
<pre style="margin-left: 40px;">&gt; ./MobileReframer.py<br><br>Usage:<br>    MobileReframer.py &lt;infile&gt; &lt;edlfile&gt; &lt;outfile&gt; width height &lt;tmpdir&gt;<infile><edlfile><outfile><tmpdir><infile><edlfile><outfile><tmpdir><br><br>* width and height are even numbered pixel dimensions for output video</tmpdir></outfile></edlfile></infile></tmpdir></outfile></edlfile></infile></pre>So, for example, if you run it with the following command line:<br><br><pre style="margin-left: 40px;">./MobileReframer.py myVideo.avi myEditDecisions.xml theResult.avi 240 160 /tmp/mobile_reframer_scratch</pre>This will apply the edit decisions in the xml file to the input video file and produce a result that is 240x160 pixels.<br><br>Note that you need to specify a temporary working directory for mobile reframer to use, since it needs somewhere to decompress video frames into. This temporary directory should not be being used by any other programs, including other instances of MobileReframer, and there should be enough free disk space to hold, in the worst case, the whole input video file when decompressed to raw frames and audio.<br><br><h2>Writing the edit decision XML file</h2><br>Write your edit decisions in an XML file, like this:<br>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Generator" content="Kate, the KDE Advanced Text Editor">

<blockquote><pre><b>&lt;?xml</b> version="1.0" encoding="ISO-8859-1"<b>?&gt;<br></b><b>&lt;EDL</b><span style="color: rgb(128, 128, 128);"> xmlns:xsi=</span><span style="color: rgb(170, 0, 0);">"http://www.w3.org/2001/XMLSchema-instance"</span><span style="color: rgb(128, 128, 128);"> xsi:noNamespaceSchemaLocation=</span><span style="color: rgb(170, 0, 0);">"MobileReframe.xsd"</span>&gt;<br><br>    <b>&lt;FileID&gt;</b>File identifier<b>&lt;/FileID&gt;<br><br></b><b>    &lt;Edit&gt;</b><b><br>        &lt;Start</b><span style="color: rgb(128, 128, 128);"> frame=</span><span style="color: rgb(170, 0, 0);">"0"</span>  <b>/&gt;</b><b><br>        &lt;End</b><span style="color: rgb(128, 128, 128);">   frame=</span><span style="color: rgb(170, 0, 0);">"24"</span> <b>/</b><b><b>&gt;</b></b><b><br></b><b>        </b><b><b>&lt;</b></b><b>Crop</b><span style="color: rgb(128, 128, 128);">  x1=</span><span style="color: rgb(170, 0, 0);">"0"</span><span style="color: rgb(128, 128, 128);"> y1=</span><span style="color: rgb(170, 0, 0);">"0"</span><span style="color: rgb(128, 128, 128);"> x2=</span><span style="color: rgb(170, 0, 0);">"400"</span><span style="color: rgb(128, 128, 128);"> y2=</span><span style="color: rgb(170, 0, 0);">"100"</span> <b>/</b><b><b>&gt;</b></b><b><br></b><b>    </b><b><b>&lt;</b></b><b>/Edit</b><b><b>&gt;</b></b><b><br></b><b>    </b><b><b>&lt;</b></b><b>Edit</b><b><b>&gt;</b></b><b><br></b><b>        <Start></Start></b><span style="color: rgb(128, 128, 128);"> frame=</span><span style="color: rgb(170, 0, 0);">"25"</span> <b>/</b><b><b>&gt;</b></b><b><br></b><b>        <End></End></b><span style="color: rgb(128, 128, 128);">   frame=</span><span style="color: rgb(170, 0, 0);">"49"</span> <b>/</b><b><b>&gt;</b></b><b><br>        <Crop></Crop></b><span style="color: rgb(128, 128, 128);">  x1=</span><span style="color: rgb(170, 0, 0);">"80"</span><span style="color: rgb(128, 128, 128);"> y1=</span><span style="color: rgb(170, 0, 0);">"40"</span><span style="color: rgb(128, 128, 128);"> x2=</span><span style="color: rgb(170, 0, 0);">"480"</span><span style="color: rgb(128, 128, 128);"> y2=</span><span style="color: rgb(170, 0, 0);">"140"</span> <b>/</b><b><b>&gt;</b></b><b><br></b><b>    </b><b><b>&lt;</b></b><b>/Edit</b><b><b>&gt;</b></b><b><br><br></b><b><b>&lt;</b></b><b>/ED</b><b><b>L&gt;</b></b>
  </pre></blockquote><span style="font-family: verdana,arial,helvetica,sans-serif;">The above edit decision list, or a similar one, shoudl be in the file <tt> TestEDL.xml </tt> in the MobileReframer's directory.<br><br></span>The format is pretty simple: simply specify a set of 'edits', in the order you want them to appear in the resulting video.<br><br>Each edit is a chunk of the input video specified by a start and end frame number, and then the bit of the video you want it cropped down to. Frames are numbered from zero, and coordinates are specified in pixels where (0,0) is the top left corner.<br><br>For example perhaps, for frames 25 to 49 inclusive (a 2 second chunk that starts 4 seconds into the video, assuming 25fps video) we want the video to be cropped to a region in the lower left of the image:<br><br><br>

<table align="center" border="0" cellpadding="0" cellspacing="0" height="200" width="300">
<tbody><tr>
  <td align="left" bgcolor="#dddddd" height="75" valign="top" width="50">(0,0)<br></td>
  <td style="color: rgb(102, 102, 102);" align="right" bgcolor="#dddddd" height="75" width="150">Throw this bit away</td>
  <td bgcolor="#dddddd" height="75" width="100"> <br></td>
</tr>
<tr>
  <td bgcolor="#dddddd" height="30" width="50"> <br></td>
  <td bgcolor="#ddffdd" height="30" valign="top" width="150">(100,150)</td>
  <td bgcolor="#dddddd" height="30" width="100"> <br></td>
</tr>
<tr>
  <td bgcolor="#dddddd" height="40" width="50"> <br></td>
  <td style="color: rgb(0, 153, 0);" 150="" align="center" bgcolor="#ddffdd" height="40" valign="center width=">Crop to this bit</td>
  <td bgcolor="#dddddd" height="40" width="100"> <br></td>
</tr>
<tr>
  <td bgcolor="#dddddd" height="30" width="50"> <br></td>
  <td align="right" bgcolor="#ddffdd" height="30" valign="bottom" width="150">(400,250)</td>
  <td bgcolor="#dddddd" height="30" width="100"> <br></td>
</tr>
<tr>
  <td bgcolor="#dddddd" height="25" width="50"> <br></td>
  <td bgcolor="#dddddd" height="25" width="150"> <br></td>
  <td align="right" bgcolor="#dddddd" height="25" valign="bottom" width="100">(719,575)</td></tr></tbody></table>
<br>Then to achieve this we would write, as part of our edit decisions:<br><pre><b>    &lt;Edit&gt;<br></b><b>        &lt;Start</b><span style="color: rgb(128, 128, 128);"> frame=</span><span style="color: rgb(170, 0, 0);">"25"</span> <b>/&gt;<br></b><b>        &lt;End</b><span style="color: rgb(128, 128, 128);">   frame=</span><span style="color: rgb(170, 0, 0);">"49"</span> <b>/&gt;</b><b><br>        &lt;Crop</b><span style="color: rgb(128, 128, 128);">  </span><span style="color: rgb(128, 128, 128);">x1=</span><span style="color: rgb(170, 0, 0);">"100"</span><span style="color: rgb(128, 128, 128);"> y1=</span><span style="color: rgb(170, 0, 0);">"150"</span><span style="color: rgb(128, 128, 128);"> x2=</span><span style="color: rgb(170, 0, 0);">"400"</span><span style="color: rgb(128, 128, 128);"> y2=</span><span style="color: rgb(170, 0, 0);">"250"</span><span style="color: rgb(170, 0, 0);"></span><span style="color: rgb(128, 128, 128);"></span><span style="color: rgb(170, 0, 0);"></span><span style="color: rgb(128, 128, 128);"></span><span style="color: rgb(170, 0, 0);"></span><span style="color: rgb(128, 128, 128);"></span><span style="color: rgb(170, 0, 0);"></span> <b>/</b><b><b>&gt;</b></b><br><b>    &lt;/Edit</b><b><b><b>&gt;</b></b>
</b></pre>

<p>You can write your edit decisions in any order - you don't have to preserve the chronological order of the original video. For example, perhaps the video you are editing has 10 seconds of titles 30 seconds in from the start. Your edit decisions could specify that the output video should start with a few seconds of those titles, then return to something closer to the beginning.</p><p>You don't have to use the whole video - you can use your edit decisions to cut a video down into a shorter one.</p><br><b><b><br></b></b>
                </div>
                <div class="twoC column last">
                    &nbsp;
                </div>
                <div id="footer">
                    &nbsp;
                    <br>&nbsp;
                </div>


<div class="divide"></div>
            </div>
        </div>
    </td></tr></table>


<hr>
<div id="aboutblock" style="text-align: left"; padding-left: 1em;>
<font size="-2">
   <P><img src="http://www.kamaelia.org/images/BBC-ResearchLogo-Small.png"
style="float: left; padding-right: 10px; margin-bottom: 3em;"> <a href="http://www.kamaelia.org/Home.html">Kamaelia</a>
    is an open source project originated from and guided by <a href="http://www.bbc.co.uk/rd"> BBC 
    Research</a>. For more information browse the site or get in 
    <a href="/Contact.html">contact</a>.
   <P>This is an ongoing community based development site. As a result the
   contents of this page is the opinions of the contributors of the pages
   involved not the organisations involved. Specificially, this page may
   contain personal views which are not the views of the BBC. (the site is
   powered by a wiki engine)
   <P>(C) Copyright 2008 Kamaelia Contributors, including the British
   Broadcasting Corporation, All Rights Reserved
</font>
</div>
</div>
<div style="display:none">
This web site is powered by the same code created for the
<a href="http://www.bickermanor.org/"> bicker manor</a> project. For more
details, contact Michael Sparks at BBC Research directly (cf contact)
</div>
</body>
</html>



