<html>
<head>
<title> Docs/Axon/Axon.background </title>
<meta name="description" content="Kamaelia - making concurrency simpler in python - Docs/Axon/Axon.background">
<meta name="keywords" content="python concurrency generators threads processes component system experts beginners media networking">
<link rel=stylesheet type="text/css" href="/newcss.css">
  </head>
<body style="font-size: 10pt; font-family: verdana,arial,helvetica,sans-serif; line-height: 1.8;">
</div>

</span></p>

<div id="centreinbrowser">
    <table><tr><td>
        <div id="contentwrapper">
            <div id="contentpanel">
                <div class="column twoC largertext">  &nbsp; </div>
                <div class="column twoC largertext">  &nbsp;  </div>
                <div class="column twoC largertext"> <P class="orange" align="center">  <b><a href="/Home.html"> Home</a></b> </div>
                <div class="column twoC largertext"> 
<P class="orange" align="center"> 
<b><a href="/About.html" class="smallertext">About</a>, 
<a href="/Sitemap.html" class="smallertext">Index</a>, 
<a href="/RecentChanges.html" class="smallertext">Changes</a></b>
  </div>
                <div class="column twoC largertext"> <P class="orange" align="center">  <b> <a href="/Developers/">Developers</a> </b> </div>
                <div class="column last twoC"> <P class="orange" align="center"> 
<b>
<span class="largertext">&nbsp;</span>
<!--   <span class="largertext"><a href="/UserLogin.html">Login</a>/<a href="/UserRegistration.html">Register</a> </span>  -->
<!--  </b> -->
</b>
 </div>

<div class="divide"></div>
                <div id="masthead">
                    &nbsp;
                    <br>
                </div>
                <div class="fourC column">
                    &nbsp;
                </div>
                <div class="fourC column">
                    &nbsp;
                </div>
                <div class="fourC column last">
                    &nbsp;
                </div>
<div class="divide"></div>
                <div class="twoC column">
                    &nbsp;
                </div>
                <div class="eightC column">
                <html>
<head>
<title>Kamaelia docs : Axon.background</title>
<style type="test/css">
pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }
</style>
</head>
<body>
<div class="container">
<div class="section">
<div class="section">
<h2><a class="reference" href="/Docs/Axon/Axon.html">Axon</a>.<a class="reference" href="/Docs/Axon/Axon.background.html">background</a></h2>
</div>
</div>
<div class="section">
<h1>Running an Axon system in a separate thread</h1>
<div class="container">
<ul class="simple">
<li><strong>class <a class="reference" href="/Docs/Axon/Axon.background.background.html">background</a></strong></li>
</ul>
</div>
<ul class="simple">
<li><a class="reference" href="#59">Example Usage</a><ul>
</ul>
</li>
<li><a class="reference" href="#60">Behavour</a><ul>
</ul>
</li>
</ul>
</div>
<div class="section">
<p>The background class makes it easy to run an Axon system in a separate
thread (in effect: in the background).</p>
<p>This simplifies integration of Axon/Kamaelia code into other python code.
See also <a class="reference" href="/Docs/Axon/Axon.Handle.html">Axon.Handle</a> for a simple way to wrap a component in a thread safe
way to access its inboxes and outboxes.</p>
<div class="section">
<h2 id="59"><a id="example-usage" name="example-usage">Example Usage</a></h2>
<p>At its simplest, you could run a Kamaelia task independently in the background
- such as a simple network connection, that dumps received data into a thread
safe queue, after de-chunking it into lines of text.</p>
<p>NOTE: This example can be achieved more simply by using <a class="reference" href="/Docs/Axon/Axon.Handle.html">Axon.Handle</a>. See the
documentation of <a class="reference" href="/Docs/Axon/Axon.Handle.html">Axon.Handle</a> to find out more.</p>
<ol class="arabic">
<li><p class="first">We implement a simple component to collect the data:</p>
<pre class="literal-block">
from <a class="reference" href="/Docs/Axon/Axon.background.html">Axon.background</a> import background
from <a class="reference" href="/Docs/Axon/Axon.Component.html">Axon.Component</a> import component

class Receiver(component):
    def __init__(self, queue):
        super(Bucket,self).__init__()
        self.q = queue

    def main(self):
        while 1:
            while self.dataReady(&quot;inbox&quot;):
                self.q.put(self.recv(&quot;inbox&quot;))
            self.pause()
            yield 1
</pre>
</li>
<li><p class="first">Then we create a background object and call its start() method:</p>
<pre class="literal-block">
from <a class="reference" href="/Docs/Axon/Axon.background.html">Axon.background</a> import background

background().start()
</pre>
</li>
<li><p class="first">Finally, we create and activate our Kamaelia pipeline of components,
including the receiver component we've just written, passing it a thread-safe
queue to put the data into:</p>
<pre class="literal-block">
from Kamaelia.Chassis.Pipeline import Pipeline
from Kamaelia.Internet.TCPClient import TCPClient
from Kamaelia.Visualisation.PhysicsGraph import chunks_to_lines
from Queue import Queue

queue = Queue()

Pipeline(
    TCPClient(&quot;my.server.com&quot;, 1234),
    chunks_to_lines(),
    Receiver(queue)
).activate()
</pre>
</li>
</ol>
<p>We can now fetch items of data, from the queue when they arrive:</p>
<pre class="literal-block">
received_line = queue.get()
</pre>
</div>
<div class="section">
<h2 id="60"><a id="behavour" name="behavour">Behavour</a></h2>
<p>Create one of these and start it running by calling its start() method.</p>
<p>After that, any components you activate will default to using this
scheduler.</p>
<p>Only one instance can be used within a given python interpreter.</p>
<p>The background thread is set as a &quot;daemon&quot; thread. This means that if your
program exits, this background thread will be killed too. If it were not a
daemon, then it would prevent the python interpreter terminating until the
components running in it had all terminated too.</p>
</div>
</div>
<hr class="docutils" />
<div class="section">
<h1><a class="reference" href="/Docs/Axon/Axon.html">Axon</a>.<a class="reference" href="/Docs/Axon/Axon.background.html">background</a>.<a class="reference" href="/Docs/Axon/Axon.background.background.html">background</a></h1>
<div class="section">
<h2 id="symbol-background">class background(threading.Thread)</h2>
<div class="section">
<p>A python thread which runs the Axon Scheduler. Takes the same arguments
at creation that Axon.Scheduler.scheduler.run.runThreads accepts.</p>
<p>Create one of these and start it running by calling its start() method.</p>
<p>After that, any components you activate will default to using this
scheduler.</p>
<p>Only one instance can be used within a given python interpreter.</p>
</div>
<div class="section">
<h3>Methods defined here</h3>
<div class="section">
<h4><a id="symbol-background.__init__" name="symbol-background.__init__">__init__(self[, slowmo][, zap])</a></h4>
</div>
<div class="section">
<h4><a id="symbol-background.run" name="symbol-background.run">run(self)</a></h4>
</div>
</div>
<div class="section">
</div>
</div>
</div>
</div>









<div class="section">
<h1>Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be clearer?
Want to help improve it? Constructive criticism is very welcome - especially if you can suggest a better rewording!</p>
<p>Please leave you feedback
<a class="reference" href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701">here</a>
in reply to the documentation thread in the Kamaelia blog.</p>
</div>




<p><i>-- Automatic documentation generator, 01 Feb 2010 at 04:00:28 UTC/GMT</i>
</body></html>

                </div>
                <div class="twoC column last">
                    &nbsp;
                </div>
                <div id="footer">
                    &nbsp;
                    <br>&nbsp;
                </div>


<div class="divide"></div>
            </div>
        </div>
    </td></tr></table>


<hr>
<div id="aboutblock" style="text-align: left"; padding-left: 1em;>
<font size="-2">
   <P><img src="http://www.kamaelia.org/images/BBC-ResearchLogo-Small.png"
style="float: left; padding-right: 10px; margin-bottom: 3em;"> <a href="http://www.kamaelia.org/Home.html">Kamaelia</a>
    is an open source project originated from and guided by <a href="http://www.bbc.co.uk/rd"> BBC 
    Research</a>. For more information browse the site or get in 
    <a href="/Contact.html">contact</a>.
   <P>This is an ongoing community based development site. As a result the
   contents of this page is the opinions of the contributors of the pages
   involved not the organisations involved. Specificially, this page may
   contain personal views which are not the views of the BBC. (the site is
   powered by a wiki engine)
   <P>(C) Copyright 2008 Kamaelia Contributors, including the British
   Broadcasting Corporation, All Rights Reserved
</font>
</div>
</div>
<div style="display:none">
This web site is powered by the same code created for the
<a href="http://www.bickermanor.org/"> bicker manor</a> project. For more
details, contact Michael Sparks at BBC Research directly (cf contact)
</div>
</body>
</html>



