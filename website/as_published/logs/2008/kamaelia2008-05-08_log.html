<html><body><table>
            <tr><td>[00:11] &lt Davbo&gt Ah</td></tr>
            <tr><td>[00:11] &lt Davbo&gt fixed it</td></tr>
            <tr><td>[00:12] &lt Davbo&gt no idea what it was</td></tr>
            <tr><td>[00:13] &lt j_baker&gt Heh... I love those errors.</td></tr>
            <tr><td>[00:15] &lt Davbo&gt time for a huuuge patch</td></tr>
            <tr><td>[00:22] &lt Davbo&gt brb</td></tr>
            <tr><td>[00:24] *** Davbo has joined #kamaelia</td></tr>
            <tr><td>[00:40] &lt Lawouach&gt well good night :)</td></tr>
            <tr><td>[00:41] &lt Davbo&gt g'night Lawouach</td></tr>
            <tr><td>[00:41] &lt Lawouach&gt ta</td></tr>
            <tr><td>[00:41] &lt Lawouach&gt way too many rhums again</td></tr>
            <tr><td>[00:42] &lt Lawouach&gt meh</td></tr>
            <tr><td>[00:42] &lt Davbo&gt rhums? lol</td></tr>
            <tr><td>[00:42] &lt Lawouach&gt what?</td></tr>
            <tr><td>[00:42] &lt Lawouach&gt meh</td></tr>
            <tr><td>[00:43] &lt Davbo&gt I assume that's the same as Rum?</td></tr>
            <tr><td>[00:43] &lt Lawouach&gt yeap</td></tr>
            <tr><td>[00:43] &lt Davbo&gt like, Bacardi or something</td></tr>
            <tr><td>[00:43] &lt Lawouach&gt we spell it rhum</td></tr>
            <tr><td>[00:43] &lt Davbo&gt Oh I see :)</td></tr>
            <tr><td>[00:43] &lt Lawouach&gt which is actually correct too ;)</td></tr>
            <tr><td>[00:43] &lt Davbo&gt cool, not a big fan of Rum myself though.</td></tr>
            <tr><td>[00:44] &lt Lawouach&gt oh you haven't tasted the way we make them</td></tr>
            <tr><td>[00:44] &lt Lawouach&gt trust me</td></tr>
            <tr><td>[00:44] &lt Lawouach&gt you'd love them :)</td></tr>
            <tr><td>[00:44] &lt Davbo&gt Hehe, I'll have to try some</td></tr>
            <tr><td>[00:45] &lt Lawouach&gt INdeed</td></tr>
            <tr><td>[00:45] &lt Lawouach&gt for instance, grab a good bottle of rhum and put some spices and vanillas in it for a few month</td></tr>
            <tr><td>[00:45] &lt Lawouach&gt then have a sip</td></tr>
            <tr><td>[00:46] &lt Lawouach&gt we stuff our rum of lots of different sweets, spices and fruits</td></tr>
            <tr><td>[00:46] &lt Lawouach&gt we call that "rhum arrangé"</td></tr>
            <tr><td>[00:46] &lt Davbo&gt that actually sounds quite nice</td></tr>
            <tr><td>[00:46] &lt Lawouach&gt it's brilliant</td></tr>
            <tr><td>[00:46] &lt Lawouach&gt it doesn't taste strong most of the time but has a very fine taste</td></tr>
            <tr><td>[00:46] &lt Lawouach&gt anyway</td></tr>
            <tr><td>[00:47] &lt Lawouach&gt had one too many this evening :)</td></tr>
            <tr><td>[00:47] &lt Davbo&gt Ah, the strong taste is what puts me off Rum tbh.</td></tr>
            <tr><td>[00:47] &lt Davbo&gt Whisky i'm okay with but something about Rum</td></tr>
            <tr><td>[00:47] &lt Davbo&gt I'll keep an eye out for it Lawouach :)</td></tr>
            <tr><td>[00:47] &lt Lawouach&gt ;)=</td></tr>
            <tr><td>[00:48] &lt Lawouach&gt I'll find you a recipe :)</td></tr>
            <tr><td>[00:48] &lt Lawouach&gt anyway</td></tr>
            <tr><td>[00:48] &lt Lawouach&gt goid night for now</td></tr>
            <tr><td>[00:48] &lt Lawouach&gt good</td></tr>
            <tr><td>[00:48] &lt Lawouach&gt damn it</td></tr>
            <tr><td>[00:49] &lt Davbo&gt hehe, night Lawouach</td></tr>
            <tr><td>[00:51] &lt Lawouach&gt also, before I go, I had a few of those: http://en.wikipedia.org/wiki/Mojito</td></tr>
            <tr><td>[00:51] &lt Lawouach&gt You should find a bar making good ones of those</td></tr>
            <tr><td>[00:51] &lt Lawouach&gt they are very refreshing</td></tr>
            <tr><td>[00:54] &lt Davbo&gt sounds nice</td></tr>
            <tr><td>[00:54] *** Davbo adds Mojito to his list</td></tr>
            <tr><td>[00:56] &lt Davbo&gt Heh i have all the ingredients for that cocktail anyway. Could give it a go</td></tr>
            <tr><td>[01:59] *** j_baker-laptop has joined #kamaelia</td></tr>
            <tr><td>[07:30] *** sadrul has joined #kamaelia</td></tr>
            <tr><td>[07:35] &lt Lawouach&gt morning</td></tr>
            <tr><td>[07:48] &lt MS-&gt morning</td></tr>
            <tr><td>[07:48] &lt MS-&gt (will be largely away from connectivity today)</td></tr>
            <tr><td>[07:48] &lt MS-&gt (trains, meeting, trains)</td></tr>
            <tr><td>[07:50] &lt Lawouach&gt hi mate</td></tr>
            <tr><td>[07:50] &lt Lawouach&gt that's okay</td></tr>
            <tr><td>[07:51] &lt Lawouach&gt as you might have seend yesterday</td></tr>
            <tr><td>[07:51] &lt Lawouach&gt I have ssl working with Kamaelia</td></tr>
            <tr><td>[07:51] &lt Lawouach&gt not that tough overall</td></tr>
            <tr><td>[07:51] &lt Lawouach&gt kiddin there :)</td></tr>
            <tr><td>[07:51] &lt Lawouach&gt was hell</td></tr>
            <tr><td>[07:53] &lt Lawouach&gt MS-: http://pastebin.com/d5b4c0ae</td></tr>
            <tr><td>[07:53] &lt Lawouach&gt that's basically the whole modification right there</td></tr>
            <tr><td>[07:53] &lt Lawouach&gt in ConnectedSocketAdapter</td></tr>
            <tr><td>[07:55] &lt Lawouach&gt There are few bits and pieces elsewhere but that's the core idea on already connected socket</td></tr>
            <tr><td>[07:55] *** MS- looks</td></tr>
            <tr><td>[07:55] &lt MS-&gt Where's the SSL code?</td></tr>
            <tr><td>[07:55] &lt MS-&gt Oh that line?</td></tr>
            <tr><td>[07:56] &lt MS-&gt That's the core?</td></tr>
            <tr><td>[07:56] &lt MS-&gt              self.socket = SSLSocket(self.socket)</td></tr>
            <tr><td>[07:56] &lt Lawouach&gt line 11 to 27</td></tr>
            <tr><td>[07:56] &lt Lawouach&gt well the lines around are critical too</td></tr>
            <tr><td>[07:56] &lt Lawouach&gt that one is just wrapping the connected socket into a ssl object</td></tr>
            <tr><td>[07:57] &lt Lawouach&gt it's not why it works K.</td></tr>
            <tr><td>[07:57] &lt Lawouach&gt it's the lines just before and right after</td></tr>
            <tr><td>[07:57] &lt MS-&gt The 11 to 27</td></tr>
            <tr><td>[07:57] &lt MS-&gt yes</td></tr>
            <tr><td>[07:57] &lt Lawouach&gt basically removing the socket from the selector component</td></tr>
            <tr><td>[07:57] &lt Lawouach&gt and adding the SSLed-socket back to the selector component</td></tr>
            <tr><td>[07:57] &lt MS-&gt Remove it, SSLise, re-add</td></tr>
            <tr><td>[07:57] &lt Lawouach&gt yes</td></tr>
            <tr><td>[07:58] &lt MS-&gt Why do you yield in the if ?</td></tr>
            <tr><td>[07:58] &lt Lawouach&gt hmm</td></tr>
            <tr><td>[07:58] &lt Lawouach&gt forgot that one :)</td></tr>
            <tr><td>[07:58] &lt Lawouach&gt :p</td></tr>
            <tr><td>[07:58] &lt MS-&gt hm. That code works by chance I think , I think actually it needs a yield after the first send</td></tr>
            <tr><td>[07:58] &lt MS-&gt say in line 16</td></tr>
            <tr><td>[07:58] &lt Lawouach&gt eh eh</td></tr>
            <tr><td>[07:58] &lt MS-&gt to allow the selector to remove it</td></tr>
            <tr><td>[07:58] &lt Lawouach&gt I had one right there</td></tr>
            <tr><td>[07:59] &lt MS-&gt since the selector runs in a thread these days</td></tr>
            <tr><td>[07:59] &lt Lawouach&gt but that's ok</td></tr>
            <tr><td>[07:59] &lt Lawouach&gt because in the selector component</td></tr>
            <tr><td>[07:59] &lt MS-&gt that is probably working by chance rather than by design</td></tr>
            <tr><td>[07:59] &lt Lawouach&gt I changed the order of some of the calls</td></tr>
            <tr><td>[07:59] &lt Lawouach&gt that's why it works</td></tr>
            <tr><td>[07:59] &lt MS-&gt Ah, OK</td></tr>
            <tr><td>[07:59] &lt Lawouach&gt I swapped the order between the remove and insert boxes :)</td></tr>
            <tr><td>[08:00] &lt MS-&gt Does SSLSocket change the filedescriptor number of the socket?</td></tr>
            <tr><td>[08:00] &lt Lawouach&gt no</td></tr>
            <tr><td>[08:00] &lt MS-&gt It just wraps the socket object?</td></tr>
            <tr><td>[08:00] &lt Lawouach&gt it basically wraps the socket using: socket.ssl(sock)</td></tr>
            <tr><td>[08:00] &lt Lawouach&gt yeap</td></tr>
            <tr><td>[08:00] &lt MS-&gt k</td></tr>
            <tr><td>[08:01] &lt Lawouach&gt the problem with that call is that the built-in socket.ssl does not do certificate verification</td></tr>
            <tr><td>[08:01] &lt MS-&gt And you remove it from the selector to prevent any accidental reading?</td></tr>
            <tr><td>[08:01] &lt Lawouach&gt I've tried the new ssl module but no luck</td></tr>
            <tr><td>[08:01] &lt Lawouach&gt it would close the connection eventually</td></tr>
            <tr><td>[08:01] &lt Lawouach&gt can't find out why</td></tr>
            <tr><td>[08:01] &lt Lawouach&gt yes</td></tr>
            <tr><td>[08:01] &lt MS-&gt In which case that code is safe :)</td></tr>
            <tr><td>[08:01] &lt MS-&gt which is cool</td></tr>
            <tr><td>[08:01] &lt Lawouach&gt eh eh not my first time officer :)</td></tr>
            <tr><td>[08:02] &lt MS-&gt I realise that, just asking the dumb questions to check I understand :)</td></tr>
            <tr><td>[08:02] &lt Lawouach&gt Anyhow I think my code is just a proof that it can work without breaking the whole API</td></tr>
            <tr><td>[08:02] &lt MS-&gt That clearly works nicely</td></tr>
            <tr><td>[08:02] &lt Lawouach&gt To make it into the repository we'll need a bit more code review</td></tr>
            <tr><td>[08:03] &lt Lawouach&gt The isSSL attribute is a necessary flag</td></tr>
            <tr><td>[08:03] &lt Lawouach&gt In the _safeReceive method, when the data read is empty the default behavior is to shutdown the connection</td></tr>
            <tr><td>[08:03] &lt Lawouach&gt however in a SSL context, the SSL object may be simply trying to read when the buffer is empty</td></tr>
            <tr><td>[08:04] &lt Lawouach&gt which should not close down the connection per se</td></tr>
            <tr><td>[08:04] &lt MS-&gt hm</td></tr>
            <tr><td>[08:04] &lt Lawouach&gt so that flag helps in one or two places to basically say "oh that's ok indeed"</td></tr>
            <tr><td>[08:04] &lt MS-&gt I see</td></tr>
            <tr><td>[08:05] &lt Lawouach&gt http://pastebin.com/d15f40e95</td></tr>
            <tr><td>[08:05] &lt Lawouach&gt I've updated the paste</td></tr>
            <tr><td>[08:06] &lt Lawouach&gt See the read/send methods</td></tr>
            <tr><td>[08:06] &lt Lawouach&gt when the SSL layer has starved the buffer and tries a read again it raises those errors</td></tr>
            <tr><td>[08:06] &lt MS-&gt return self.sslobj.read(size) can happily return 0</td></tr>
            <tr><td>[08:06] &lt Lawouach&gt But it's not an indication that the socket closed</td></tr>
            <tr><td>[08:06] &lt MS-&gt or rather an object of zero size</td></tr>
            <tr><td>[08:06] &lt MS-&gt fun and games</td></tr>
            <tr><td>[08:07] &lt Lawouach&gt well</td></tr>
            <tr><td>[08:07] &lt Lawouach&gt you're kidding but that only aspect actually took me hours to find out</td></tr>
            <tr><td>[08:07] &lt Lawouach&gt because in a normal socket behavior that really means "close down the connection"</td></tr>
            <tr><td>[08:07] &lt Lawouach&gt :)</td></tr>
            <tr><td>[08:07] &lt MS-&gt I'm sure it took time</td></tr>
            <tr><td>[08:08] &lt MS-&gt "fun & games" is what I say when most other people say "complete sod"</td></tr>
            <tr><td>[08:08] &lt Lawouach&gt :p</td></tr>
            <tr><td>[08:08] &lt Lawouach&gt well on the whole it took me two evenings</td></tr>
            <tr><td>[08:08] &lt Lawouach&gt so that's ok</td></tr>
            <tr><td>[08:08] &lt Lawouach&gt and I learnt more about the ConnectedSocketAdapter module</td></tr>
            <tr><td>[08:09] &lt Lawouach&gt so that's cool :)</td></tr>
            <tr><td>[08:09] &lt MS-&gt Cool</td></tr>
            <tr><td>[08:09] &lt Lawouach&gt I'll let you be now :)</td></tr>
            <tr><td>[08:09] &lt MS-&gt It's one of the oldest modules, and been modified over time, but shows it's age I think</td></tr>
            <tr><td>[08:10] &lt Lawouach&gt Oh yes</td></tr>
            <tr><td>[08:10] &lt Lawouach&gt The code is... not pretty pretty :)</td></tr>
            <tr><td>[08:10] &lt Lawouach&gt but it works well</td></tr>
            <tr><td>[08:10] &lt MS-&gt Yep</td></tr>
            <tr><td>[08:10] &lt MS-&gt Pays attention to correctness as well</td></tr>
            <tr><td>[08:11] &lt Lawouach&gt indeed :)</td></tr>
            <tr><td>[08:12] &lt Lawouach&gt anyway that now means I can play my XMPP code against Google Talk :)</td></tr>
            <tr><td>[08:12] &lt Lawouach&gt That's fun :)</td></tr>
            <tr><td>[08:13] &lt MS-&gt Excellent :)</td></tr>
            <tr><td>[08:14] &lt MS-&gt You've seen this trick from here:</td></tr>
            <tr><td>[08:14] &lt MS-&gt http://kamaelia.svn.sourceforge.net/viewvc/kamaelia/branches/private_MPS_Scratch/Apps/Kamaelia-Grey/App/greylisting.py?revision=3684&view=markup</td></tr>
            <tr><td>[08:15] &lt MS-&gt  600 class GreylistServer(MoreComplexServer):</td></tr>
            <tr><td>[08:15] &lt MS-&gt ..</td></tr>
            <tr><td>[08:15] &lt MS-&gt  605 class TCPS(TCPServer): 606</td></tr>
            <tr><td>[08:15] &lt MS-&gt  CSA = NoActivityTimeout(ConnectedSocketAdapter, timeout=config["inactivity_timeout"], debug=False)</td></tr>
            <tr><td>[08:15] &lt MS-&gt I presume?</td></tr>
            <tr><td>[08:16] &lt MS-&gt enablig...</td></tr>
            <tr><td>[08:16] &lt MS-&gt class SSLServer(MoreComplexServer):</td></tr>
            <tr><td>[08:16] &lt MS-&gt  class TCPS(TCPServer):</td></tr>
            <tr><td>[08:16] &lt MS-&gt  CSA = SylvainsNewVersionOfCSA # ?</td></tr>
            <tr><td>[08:17] &lt Lawouach&gt I didn't remember it no</td></tr>
            <tr><td>[08:18] &lt Lawouach&gt well</td></tr>
            <tr><td>[08:18] &lt Lawouach&gt the pb is that I had to modify TCPClient</td></tr>
            <tr><td>[08:18] &lt Lawouach&gt to add two boxes</td></tr>
            <tr><td>[08:19] &lt Lawouach&gt a makessl as an inbox</td></tr>
            <tr><td>[08:19] &lt Lawouach&gt a sslready as an outbox</td></tr>
            <tr><td>[08:19] &lt MS-&gt yes</td></tr>
            <tr><td>[08:19] &lt Lawouach&gt so you can't just use your trick above ;)</td></tr>
            <tr><td>[08:19] &lt MS-&gt In which case I need to think of a way to make that trick more capable :-)</td></tr>
            <tr><td>[08:19] &lt MS-&gt Which is neat</td></tr>
            <tr><td>[08:19] &lt MS-&gt I like that sort of problem</td></tr>
            <tr><td>[08:20] &lt MS-&gt Whether we'd want to use it, dunno :)</td></tr>
            <tr><td>[08:20] &lt Lawouach&gt :)</td></tr>
            <tr><td>[08:22] &lt MS-&gt OK, afk. Back late this evening. (ie after 10pm) if back on at all today :)</td></tr>
            <tr><td>[08:22] &lt MS-&gt have a nice day</td></tr>
            <tr><td>[08:22] *** MS- has parted #kamaelia</td></tr>
            <tr><td>[08:50] *** orphans has joined #kamaelia</td></tr>
            <tr><td>[09:14] *** Uraeus has joined #kamaelia</td></tr>
            <tr><td>[09:18] *** bcarlyon|laptop has joined #kamaelia</td></tr>
            <tr><td>[10:19] &lt vmlemon&gt Hi</td></tr>
            <tr><td>[11:52] *** Lawouach has joined #kamaelia</td></tr>
            <tr><td>[12:27] *** Davbo has joined #kamaelia</td></tr>
            <tr><td>[12:33] *** Davbop has joined #kamaelia</td></tr>
            <tr><td>[13:33] *** Davbo has joined #kamaelia</td></tr>
            <tr><td>[13:35] *** Davbo has parted #kamaelia</td></tr>
            <tr><td>[13:35] *** Davbo has joined #kamaelia</td></tr>
            <tr><td>[13:35] *** Davbo has parted #kamaelia</td></tr>
            <tr><td>[13:51] *** Davbo has joined #kamaelia</td></tr>
            <tr><td>[13:51] *** Davbo has parted #kamaelia</td></tr>
            <tr><td>[14:33] *** vmlemon has joined #kamaelia</td></tr>
            <tr><td>[15:04] *** Davbo has joined #kamaelia</td></tr>
            <tr><td>[15:07] *** j_baker has joined #kamaelia</td></tr>
            <tr><td>[17:25] *** sadrul has joined #kamaelia</td></tr>
            <tr><td>[18:05] &lt orphans&gt mhrd, Lawouach, ping?</td></tr>
            <tr><td>[18:06] &lt Lawouach&gt pong</td></tr>
            <tr><td>[18:07] &lt orphans&gt hey, you got a moment to look at some code - I'm getting 100% cpu usage and I have no idea why :)</td></tr>
            <tr><td>[18:08] &lt Lawouach&gt sure</td></tr>
            <tr><td>[18:08] &lt Lawouach&gt shoot</td></tr>
            <tr><td>[18:09] &lt orphans&gt erm, maybe easier if I do a commit - that cool by you?</td></tr>
            <tr><td>[18:09] &lt Lawouach&gt yeap</td></tr>
            <tr><td>[18:16] &lt orphans&gt Lawouach, ok - commited. the thing which is dodgy is UITest.py - if you have a console echoer after the OSC element it works fine, but if you stick a simplepeer the cpu jumps to 100%</td></tr>
            <tr><td>[18:18] &lt Lawouach&gt hang on</td></tr>
            <tr><td>[18:19] &lt Lawouach&gt meh</td></tr>
            <tr><td>[18:19] &lt Lawouach&gt I forgot to install OSC</td></tr>
            <tr><td>[18:19] *** Lawouach is reading orphans's INSTALL instructions</td></tr>
            <tr><td>[18:19] &lt orphans&gt :) yay!</td></tr>
            <tr><td>[18:20] *** orphans notices install instructions are wrong :S</td></tr>
            <tr><td>[18:20] *** Uraeus has joined #kamaelia</td></tr>
            <tr><td>[18:21] &lt Lawouach&gt bah</td></tr>
            <tr><td>[18:21] &lt Lawouach&gt so I launch UITest.py</td></tr>
            <tr><td>[18:21] &lt Lawouach&gt what should I do next?</td></tr>
            <tr><td>[18:22] &lt orphans&gt ok, in UITest.py uncomment the line which creates the SimplePeer and the line which links it in the graphline</td></tr>
            <tr><td>[18:22] &lt orphans&gt and see your cpu shoot up :)</td></tr>
            <tr><td>[18:24] &lt Lawouach&gt indeed</td></tr>
            <tr><td>[18:25] &lt orphans&gt kinda finding it hard to see where that's happening though, given that you're just sticking an extra component in the chain</td></tr>
            <tr><td>[18:25] &lt Lawouach&gt the SimplePeer doesn't have a self.pause()</td></tr>
            <tr><td>[18:25] &lt Lawouach&gt That'd explain the CPU consumption</td></tr>
            <tr><td>[18:25] &lt orphans&gt yeah, I saw that - should it have?</td></tr>
            <tr><td>[18:26] &lt orphans&gt :)</td></tr>
            <tr><td>[18:27] &lt Lawouach&gt bingo</td></tr>
            <tr><td>[18:27] &lt Lawouach&gt I added it and the CPU does fine</td></tr>
            <tr><td>[18:27] &lt Lawouach&gt weird it missed it</td></tr>
            <tr><td>[18:27] &lt orphans&gt how come if you just pipeline a chargen to the SimplePeer it doesn't happen?</td></tr>
            <tr><td>[18:27] &lt orphans&gt (as is in the simplepeer tests)</td></tr>
            <tr><td>[18:28] &lt Lawouach&gt I'm not sure</td></tr>
            <tr><td>[18:30] &lt orphans&gt fair enough :)</td></tr>
            <tr><td>[18:31] &lt orphans&gt should I email a patch to put the pause in to the list?</td></tr>
            <tr><td>[18:33] &lt Lawouach&gt You may yes but I think MS could have an explanation :)</td></tr>
            <tr><td>[18:34] &lt orphans&gt k - I'll ask MS when he's around. Cheers for the help Lawouach</td></tr>
            <tr><td>[18:34] &lt Lawouach&gt np</td></tr>
            <tr><td>[18:35] *** orphans will hopefully have the first bit of sound playing over the next half-hour or so</td></tr>
            <tr><td>[18:50] &lt Lawouach&gt :)</td></tr>
            <tr><td>[19:32] *** bcarlyon|ubuntu has joined #kamaelia</td></tr>
            <tr><td>[19:33] *** bcarlyon|ubuntu has joined #kamaelia</td></tr>
            <tr><td>[20:39] *** Davbo wonders how he ever programmed Java without Eclipse</td></tr>
            <tr><td>[21:25] &lt Davbo&gt s/programmed/ coded in</td></tr>
            <tr><td>[21:25] &lt Davbo&gt don't want Sun suing me for libel over these IRC logs ;)</td></tr>
            <tr><td>[21:26] *** Davbo didn't actually program Java. - It's the last programming language I'd want to take credit for</td></tr>
            <tr><td>[22:49] *** Davbo has joined #kamaelia</td></tr>
