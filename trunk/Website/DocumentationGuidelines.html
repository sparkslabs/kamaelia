<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:10pt;font-family:URW Gothic L">
<p><span style="font-size:22pt;font-weight:600">Documenting Components</span></p>
<p align="right"><span style="font-size:14pt">Some guidelines</span></p>
<p>[[boxright]<span style="font-weight:600">Note!</span> It is preferable for there to be some documentation, rather than no documentation, even if it breaks these guidelines or is incomplete. Don't let these guidelines stop you writing! The nature of open source is iterative development. The same applies to the docs. ]</p>
<p>These are the current guidelines for documenting Kamaelia components. This is more a documentation of current best practice. ie this is a <span style="font-weight:600">descriptive</span> set of <span style="font-weight:600">guidelines</span> about <span style="font-style:italic">&quot;how we have documented things and find works for us&quot;</span>. This is <span style="font-weight:600">not</span> a <span style="font-weight:600">prescriptive</span> <span style="font-style:italic">&quot;things must be documented this way&quot;</span>.</p>
<p>This is effectively a description of the documentation style that has already been used, rather than a set of guidelines written in advance of starting to document. These guidelines cover:</p>
<ul type="disc"><li>Writing style</li>
<li>Structure and format</li>
<li>Example(s)</li>
<li>A template</li></ul>
<p>No documentation is perfect. Much of that which has already been written probably breaks many of the guidelines described here!</p>
<p><span style="font-size:14pt;font-weight:600">Why document - Who's the Reader?</span></p>
<p dir="ltr">Documentation should serve two different sets of readers:</p>
<ul type="disc"><li><span style="font-weight:600">USERS</span> - I want to use this component: what does it do? how do I plug it together with other components? how does it behave?</li>
<li><span style="font-weight:600">Component Developers/Maintainers</span> - I want to modify this component: how does the component work inside? why does it work that way and not another?</li></ul>
<p>Because most components are small and lightweight, the main focus of these guidelines is on documenting for usage.</p>
<p><span style="font-size:14pt;font-weight:600">Writing style</span></p>
<p>Aim to write in the following way:</p>
<ul type="disc"><li>Consistent, short, clear and unambiguous statements.</li>
<ul type="disc"><li>If a sentance has more than 10 words, it is very likely too long. Make sentances more like babytalk. This sounds patronising, but reduces effort needed to understand the sentance. It means your reader can focus on what your code means. </li>
<li>Also, don't skip words.</li></ul>
<li>The present tense</li>
<li>Writing as if you are talking to the reader</li>
<li>Use the imperative - rather than saying <span style="font-style:italic">&quot;when you do X...&quot;</span>, instead say <span style="font-style:italic">&quot;do X to...&quot;</span></li>
<li>Refer to inboxes, outboxes and components by name, eg. <span style="font-style:italic">the &quot;inbox&quot; inbox</span> or: <span style="font-style:italic">ConsoleEchoer</span></li></ul>
<p>For example:</p>
<ul type="square"><li><span style="font-style:italic;color:#006700">The TopologyViewerComponent manifests as a pygame display surface. As it is sent topology information, nodes and links between them will appear.</span></li></ul>
<p>As opposed to the unnecessarily wordy:</p>
<ul type="square"><li><span style="font-style:italic;color:#aa0003">A pygame display surface is used by the TopologyViewerComponent. When topology information has been sent by another component, this one will display the nodes and linkages between them.</span></li></ul>
<p>Another example:</p>
<ul type="square"><li><span style="font-style:italic;color:#006700">If a shutdownMicroprocess or producerFinished message is received on this component's &quot;control&quot; inbox this it will pass it on out of its &quot;signal&quot; outbox and immediately terminate.</span></li></ul>
<p>As opposed to the somewhat more ambiguous:</p>
<ul type="square"><li><span style="font-style:italic;color:#aa0003">The component shuts down when it receives a shutdown message.</span></li></ul>
<p>You could argue however that the following is better yet:</p>
<ul type="disc"><li dir="ltr">The component runs until it recieves a shutdown message. </li></ul>
<p dir="ltr"></p>
<ul type="disc"><div dir="ltr">From this component's perspective, shutdown messages are shutdownMicroprocess or producerFinished objects. The shutdown message is recieved on the component's inbox. </div></ul>
<p dir="ltr"></p>
<ul type="disc"><div dir="ltr">It will send this shutdown message to it's &quot;signal&quot; outbox. The component will then shutdown.</div></ul>
<p>This can often simply be a matter of taste of course. Terse is often good, but unnecessarily terse is bad.</p>
<p><span style="font-size:14pt;font-weight:600">Structure and format</span></p>
<p>The formatting style being used is broadly the <a href="http://docutils.sourceforge.net/rst.html">reStructured Text</a> format. For an overview of this, see the <a href="http://docutils.sourceforge.net/docs/user/rst/quickstart.html">primer</a>. This has been chosen because of its simplicity and readability, but also because it can be machine processed to automate the generation of, for example, website documentation.</p>
<p>Document component(s) within a sourcefile by writing:</p>
<ol><li>Write a <span style="font-weight:600">detailed docstring at the top</span>, containing:</li>
<ul type="disc"><li>One paragraph introduction</li>
<li>&quot;Example Usage&quot; section</li>
<li>&quot;How does it work&quot; section</li>
<li>Extra sections/sub sections if needed </li></ul>
<li>A <span style="font-weight:600">docstring for the class</span>, containing:</li>
<ul type="disc"><li>Constructor syntax:[[pre]<span style="font-family:courier new">   MyComponent(arg1,arg2[,optarg3]) -&gt; new MyComponent component. ]</span></li>
<li>One sentence description:[[pre]<span style="font-family:courier new">	Component that does X. ]</span></li>
<li>Description of initializer arguments:[[pre]<span style="font-family:courier new">    Keyword arguments:<br />    - arg1     -- what this is<br />    - arg2     -- what this is<br />    - optarg3  -- None, or what value it takes (default=None)<br />]</span></li></ul>
<div></div>
<li>A <span style="font-weight:600">docstring for each inbox and outbox</span>, as the value of the key:value pair [[pre]<span style="font-family:courier new">    Inboxes = { &quot;inbox&quot; : &quot;Items to be xxxx'ed&quot;,<br />                &quot;control&quot; : &quot;Shutdown signalling&quot;,<br />              }<br />]<br /></span><span style="font-family:sans serif">unused boxes should be documented as such</span></li>
<div></div>
<li>A <span style="font-weight:600">standard docstring for the initalizer</span> method:[[pre] <span style="font-family:courier new">&quot;&quot;&quot;x.__init__(...) initializes x; see x.__class__.__doc__ for signature&quot;&quot;&quot; ]</span></li>
<ul type="disc"><li><span style="font-style:italic">I'm not totally convinced about this. Having nothing there is occasionally a pain -- Michael.</span></li></ul>
<div></div>
<li>Docstrings for other methods and comments within the code, to assist developers</li></ol>
<p>See the example(s) and template below for the recommended syntax for these parts.</p>
<p>If your sourcefile contains more than one component, then concatenate the detailed docstrings for each component into one. Preface it with a top level heading and one or two paragraphs of introduction.</p>
<p>Some general consistency rules:</p>
<ul type="disc"><li>Wordwrap at 80 columns to aid readability</li>
<ul type="disc"><li>exceptions can be made for list items and other short indented pieces.</li></ul>
<div></div>
<li>Leave 3 blank lines between the end of a section and the heading for the next.</li>
<div></div>
<li>Write python data structures in the language's own syntax. For example, a python list:</li>
<div><span style="font-family:courier new">[ &quot;moveto&quot;, width, height ]</span></div></ul>
<p><span style="font-size:14pt;font-weight:600">Example</span></p>
<p>The best examples are within the Kamaelia codebase itself. Here is a snapshot (April 2006) of <span style="font-family:Courier New">Kamaelia/Internet/TCPClient.py</span> containing the <span style="font-family:Courier New">TCPClient</span> component. The documentation is highlighted in green:</p>
<p><span style="font-family:courier new;color:#006700">[[pre]<br />&quot;&quot;&quot;\<br />=================<br />Simple TCP Client<br />=================<br /><br />This component is for making a TCP connection to a server. Send to its &quot;inbox&quot;<br />inbox to send data to the server. Pick up data received from the server on its<br />&quot;outbox&quot; outbox.<br /><br /><br /><br />Example Usage<br />-------------<br /><br />Sending the contents of a file to a server at address 1.2.3.4 on port 1000::<br /><br />    pipeline( RateControlledFileReader(&quot;myfile&quot;, rate=100000),<br />              TCPClient(&quot;1.2.3.4&quot;, 1000),<br />            ).activate()<br /><br /><br /><br />How does it work?<br />-----------------<br /><br />TCPClient opens a socket connection to the specified server on the specified<br />port. Data received over the connection appears at the component's &quot;outbox&quot;<br />outbox as strings. Data can be sent as strings by sending it to the &quot;inbox&quot;<br />inbox.<br /><br />An optional delay (between component activation and attempting to connect) can<br />be specified. The default is no delay.<br /><br />It creates a ConnectedSocketAdapter (CSA) to handle the socket connection and<br />registers it with a selectorComponent so it is notified of incoming data. The<br />selectorComponent is obtained by calling<br />selectorComponent.getSelectorService(...) to look it up with the local<br />Coordinating Assistant Tracker (CAT).<br /><br />TCPClient wires itself to the &quot;FactoryFeedback&quot; outbox of the CSA. It also wires<br />its &quot;inbox&quot; inbox to pass data straight through to the CSA's &quot;DataSend&quot; inbox,<br />and its &quot;outbox&quot; outbox to pass through data from the CSA's &quot;outbox&quot; outbox.<br /><br />Socket errors (after the connection has been successfully established) may be<br />sent to the &quot;signal&quot; outbox.<br /><br />This component will terminate if the CSA sends a socketShutdown message to its<br />&quot;FactoryFeedback&quot; outbox.<br /><br />Messages sent to the &quot;control&quot; inbox are ignored - users of this component<br />cannot ask it to close the connection.<br />&quot;&quot;&quot;</span><span style="font-family:courier new"><br /><br />class TCPClient(component):<br /></span><span style="font-family:courier new;color:#006700">   &quot;&quot;&quot;\<br />   TCPClient(host,port[,delay]) -&gt; new TCPClient component.<br /><br />   Establishes a TCP connection to the specified server.<br />   <br />   Keyword arguments:<br />   - host     -- address of the server to connect to (string)<br />   - port     -- port number to connect on<br />   - delay    -- delay (seconds) after activation before connecting (default=0)<br />   &quot;&quot;&quot;</span><span style="font-family:courier new"><br />   Inboxes  = { &quot;inbox&quot;           :</span><span style="font-family:courier new;color:#006700"> &quot;data to send to the socket&quot;,</span><span style="font-family:courier new"><br />                &quot;_socketFeedback&quot; : </span><span style="font-family:courier new;color:#006700">&quot;notifications from the ConnectedSocketAdapter&quot;,</span><span style="font-family:courier new"><br />                &quot;control&quot;         :</span><span style="font-family:courier new;color:#006700"> &quot;NOT USED&quot;</span><span style="font-family:courier new"><br />              }<br />   Outboxes = { &quot;outbox&quot;         : </span><span style="font-family:courier new;color:#006700"> &quot;data received from the socket&quot;,</span><span style="font-family:courier new"><br />                &quot;signal&quot;         : </span><span style="font-family:courier new;color:#006700"> &quot;socket errors&quot;,</span><span style="font-family:courier new"><br />                &quot;_selectorSignal&quot; :</span><span style="font-family:courier new;color:#006700"> &quot;communicating with a selectorComponent&quot;,</span><span style="font-family:courier new"><br />              }<br /><br />   def __init__(self,host,port,delay=0):<br /></span><span style="font-family:courier new;color:#006700">      &quot;&quot;&quot;x.__init__(...) initializes x; see x.__class__.__doc__ for signature&quot;&quot;&quot;</span><span style="font-family:courier new"><br />      super(TCPClient, self).__init__()<br />      self.host = host<br />      self.port = port<br />      self.delay=delay<br /><br />   ...<br />]</span></p>
<p><span style="font-size:14pt;font-weight:600">A template</span></p>
<p>The following 'template' points out some of the formatting and stylistic points already described:</p>
<p><span style="font-family:courier new">[[pre]<br />#!/usr/bin/env python<br /># &lt;&lt;licence terms go here&gt;&gt;<br /><br /></span><span style="font-family:courier new;color:#006700">&quot;&quot;&quot;\<br />============<br />What it does<br />============<br /><br />Short, one paragraph description of what this component does, or the task it achieves.<br /><br /><br /><br />Example Usage<br />-------------<br />What this shows followed by double colon::<br />    def func():<br />        print &quot;really really simple minimal code fragment&quot;<br /><br />Indicate any runtime user input with a python prompt::<br />    &gt;&gt;&gt; func()<br />    really really simple minimal code fragment<br /><br />Optional comment on any particularly important thing to note about the above <br />example.<br /><br />How does it work?<br />-----------------<br /><br />Statements, written in the present tense, describing in more detail what the <br />component does.<br /><br />Explicitly refer to &quot;named&quot; inbox an &quot;named&quot; outbox to avoid ambiguity.<br /><br />Does the component terminate? What are the conditions?<br /><br />If the 'xxxx' argument is set to yyy during initialization, then something<br />different happens.<br /><br />A subheading for a subtopic<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br />Lists of important items might be needed, such as commands:<br />    the item<br />        A description of the item, what it is and what it does, and maybe <br />        consequences of that.<br /><br />    another item<br />        A description of the item, what it is and what it does, and maybe <br />        consequences of that.<br /><br />You may also want bullet lists:<br />- first item<br />- second item<br /><br />Optional extra topics<br />---------------------<br /><br />May be necessary to describe something separately, eg. a complex data structure <br />the component expects to receive, or the GUI interface it provides.<br />&quot;&quot;&quot;<br /></span><span style="font-family:courier new">class TheComponent(...):<br />   </span><span style="font-family:courier new;color:#006700"> &quot;&quot;&quot;\<br />    TheComponent(arg[,optarg]) -&gt; new TheComponent component.<br /><br />    Component that does something.<br /><br />    Keyword arguments:<br />    - arg     -- specifys something<br />    - optarg  -- None, or something else (default=None)<br />    &quot;&quot;&quot;</span><span style="font-family:courier new"><br /><br />    Inboxes = { &quot;inbox&quot;   : </span><span style="font-family:courier new;color:#006700">&quot;What you send to here&quot;,<br /></span><span style="font-family:courier new">                &quot;control&quot; : </span><span style="font-family:courier new;color:#006700">&quot;Shutdown signalling&quot;,<br /></span><span style="font-family:courier new">              }<br />    Outboxes = { &quot;outbox&quot; : </span><span style="font-family:courier new;color:#006700">&quot;What comes out of here,<br /></span><span style="font-family:courier new">                 &quot;something&quot; :</span><span style="font-family:courier new;color:#006700"> &quot;NOT USED&quot;,<br /></span><span style="font-family:courier new">                 &quot;signal&quot; :</span><span style="font-family:courier new;color:#006700"> &quot;Shutdown signalling&quot;,<br /></span><span style="font-family:courier new">               }<br /><br />    def __init__(self, ...):<br /></span><span style="font-family:courier new;color:#006700">        &quot;&quot;&quot;x.__init__(...) initializes x; see x.__class__.__doc__ for signature&quot;&quot;&quot;<br /></span><span style="font-family:courier new">        ...<br /><br />    ...rest of the component...<br />]</span></p>
<p></p>
</body></html>
